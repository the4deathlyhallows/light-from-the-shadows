üí° Interview Question (APT Context)
"You suspect activity from Lazarus Group (APT38) inside a financial enterprise network. They‚Äôre known for Kerberoasting, credential dumping, and moving laterally with PsExec or WMI. How would you detect and hunt for Lazarus activity in logs or Splunk, and what would help you distinguish it from legitimate admin operations?"
‚úÖ Strong Answer
1. Kerberoasting (T1558.003)
Lazarus TTP: Requesting TGS tickets for service accounts to crack offline.
Detection: EventID 4769 (TGS requests).
Splunk Hunt:
index=wineventlog EventCode=4769 
(EncryptionType=0x17 OR EncryptionType=0x18) 
| stats count by Account_Name, Service_Name, src_ip
Baseline vs Malicious: Service accounts shouldn‚Äôt have a high volume of RC4-encrypted TGS requests coming from non-admin endpoints.
2. Credential Dumping (T1003)
Lazarus TTP: Dump LSASS memory or use tools like procdump + Mimikatz.
Detection:
EventID 4656 (object handle to LSASS).
EventID 4688 (suspicious processes like procdump.exe).
Splunk Hunt:
index=wineventlog (EventCode=4656 OR EventCode=4688) 
Object_Name="*lsass.exe*" 
| stats count by Process_Name, Account_Name, host
Baseline vs Malicious: EDR/AV may touch LSASS, but unexpected binaries or user accounts doing so is suspicious.
3. Lateral Movement with PsExec (T1570 / T1569.002)
Lazarus TTP: Use PsExec to execute commands remotely.
Detection:
EventID 7045 (new service installation).
EventID 5145 (SMB file share access).
Splunk Hunt:
index=wineventlog (EventCode=7045 OR EventCode=5145) 
| stats count by Service_Name, Account_Name, host
Baseline vs Malicious: PsExec installs a service (PSEXESVC) ‚Äî rare outside IT teams. If it shows up broadly, that‚Äôs suspect.
4. WMI Execution (T1047)
Lazarus TTP: Remote code execution via WMI for stealth.
Detection: EventIDs 5858, 5861.
Splunk Hunt:
index=wineventlog (EventCode=5858 OR EventCode=5861) 
| stats count by Account_Name, ComputerName
Baseline vs Malicious: Jump servers may use WMI, but peer-to-peer workstation WMI traffic = unusual.
5. Analyst Closing Point
‚ÄúWith Lazarus, I‚Äôd focus on correlations: Kerberoast activity followed by LSASS access, then PsExec/WMI movement, all from the same host or account. Each event alone might look like admin activity, but chained together it reveals Lazarus tradecraft. Building correlation rules in Splunk to tie these signals is key to detection.‚Äù
