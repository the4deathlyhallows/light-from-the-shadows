Good request. Below are two detection artifacts â€” one focused on FreeIPA (especially given its recent CVE) and one focused on GitLab (self-managed / on-prem), informed by the recent breach of Red Hatâ€™s GitLab instance â€” plus a master detection template combining both into a â€œsuspicious identity / repository compromiseâ€ detection. You can use or adapt them for Splunk, Chronicle (YARA-L), or your detection engineering pipeline.

âœ… Why these detections matter now

FreeIPA recently fixed a serious privilege escalation / authentication bypass issue (CVE-2025-4404 + related fixes). 
freeipa.org
+1

In October 2025, Red Hat confirmed that a self-managed GitLab instance was compromised, leading to theft of 570 GB of data from ~28,000 repos, including credentials, infrastructure configs, auth tokens, customer data, etc. 
Breached Company
+3
Red Hat
+3
GitLab Support
+3

As supply-chain & identity-management systems, FreeIPA + Git repositories (GitLab) are high-value â€” unauthorized or suspicious activity around them can signal serious compromise or insider abuse.

ðŸ› ï¸ Detection 1 â€” FreeIPA Abuse / Anomalous Behavior
Detection Name

IDM01_01_FreeIPA_Anomaly_Detect

Objective

Detect suspicious or anomalous activity related to FreeIPA â€” e.g., privilege escalations, unusual account aliasing, service misuse, unexpected authentication behavior â€” possibly linked to exploitation of known FreeIPA vulnerabilities.

Data Sources / Requirements

FreeIPA server logs (authentication, Kerberos, LDAP, admin/API access)

System logs (sssd, PAM, sudo, root login, service start/stop) on FreeIPA servers

Network logs (connections to LDAP, Kerberos ports, API endpoints)

Asset inventory (list of legitimate admins / service accounts)

Behavioral / Anomaly Indicators

Unexpected creation/modification of Kerberos principals â€” especially aliasing or creation of â€œadminâ€ or root-equivalent principals

Abnormal spike in Kerberos ticket issuance (TGT requests) from rarely-used accounts or new host accounts

LDAP modifications (e.g., attribute changes, user or group additions) by non-approved accounts

SSSD / PAM failures or unusual login attempts from unexpected hosts

Unexpected service restarts of FreeIPA components after hours â€” ldap, krb5kdc, sssd, etc.

Network connections to LDAP/Kerberos ports from hosts not normally interacting with FreeIPA

Example Splunk / SIEM Pseudocode Query
index=freeipa_logs OR index=system_logs  
| where (event_type IN ("kerberos_tgt_issued","ldap_modify","useradd","groupadd","service_restart"))  
  AND NOT (user IN approved_admin_list)  
| table _time host user action details

Example Chronicle / YARA-L-style Logic Sketch
rule FreeIPA_Abuse
when
  any of (
    ldap_change_event,
    kerberos_ticket_grant_event,
    service_restart_event (ipa/sssd/krb5kdc)
  )
  and not metadata.user in allowed_freeipa_admins
then alert severity = high

False-Positive / Tuning Considerations

Legit admin activity during maintenance windows â€” build an allow-list of known admin accounts & maintenance hosts

Automated scripts or valid PAMâ€“SSSD events (patching, backups) â€” cross-check with change-management logs

Response / Investigation Actions

Immediately audit changes to Kerberos principals, alias lists

Export recent LDAP change history, ticket issuance logs, authentication failures

Validate identity of accounts that performed changes â€” check for recently created or rotated credentials

Enforce multi-factor authentication for admin accounts, restrict administrative privileges, review credential hygiene

Consider re-issuing critical service credentials, renewing certificates, and rotating keys

ðŸ” Detection 2 â€” Self-Managed GitLab Repository / Secret Exposure / Unauthorized Repo Access
Detection Name

CODE01_01_GitLab_SelfHosted_Compromise_Detect

Objective

Detect potential unauthorized access, mass repository cloning/export, or credential leak events on self-hosted GitLab instances, especially when used internally for sensitive code, configuration, or infrastructure-as-code repositories (inspired by the recent Red Hat breach).

Data Sources / Requirements

GitLab audit logs (login attempts, repo clone/pull/push events, export/archive events)

System logs on GitLab server (SSH, HTTP access logs, shell access, cron jobs, backup scripts)

Network logs (large outbound data transfers, unusual IPs, high-bandwidth activity)

Asset & user inventory (authorized GitLab users, service accounts, VPN/remote IP lists)

Behavioral / Anomaly Indicators

Mass cloning / export / archive events across many repositories by a single user or service account

Unusual activity outside business hours (late night, weekends) â€” e.g., large pulls, dumps, backups

Login or access from unusual IP addresses / geolocations / VPNs not normally used by internal staff

Creation of new service accounts, tokens, or personal access tokens (PATs), especially with broad scopes or long expiry

Unexpected change in permissions â€” e.g., user granted â€œownerâ€ or â€œadminâ€ rights, or elevated group membership

Rapid successive access across many repos (indicative of bulk exfiltration)

Example Splunk / SIEM Pseudocode Query
index=gitlab_audit_logs OR index=web_access_logs
| where action IN ("git_clone","project_export","repo_archive","login")  
| stats count, earliest(_time) as first, latest(_time) as last by user, src_ip
| where count > 10 AND (now() - first) < 3600


And:

index=gitlab_audit_logs action="token_create" OR action="permission_change"
| table _time user action repo project permissions src_ip

Example Chronicle / YARA-L-style Logic Sketch
rule GitLab_SelfHosted_Repo_Exfil
when
  (audit_event.type in {"repo_clone","project_export","repo_archive"})  
  and user not in approved_repo_admins  
  and repo in sensitive_repo_list
then alert severity = high

False-Positive / Tuning Considerations

Legitimate backups by DevOps or CI/CD jobs â€” maintain an allow-list of backup/automation accounts & IP ranges

Scheduled maintenance or migration events â€” coordinate with change management

Response / Investigation Actions

Identify which repos were accessed/exported and when

List all service accounts / PATs created recently â€” review scopes and revoke unnecessary tokens

Rotate all exposed or likely-exposed secrets (API keys, credentials, tokens, certificates)

Audit code & configuration for credential hard-coding or sensitive data

Notify internal stakeholders + customers if consulting or third-party code was exposed

Implement stricter access controls, MFA, session monitoring, token expiration policies, and logging retention

ðŸ§© Master Composite Detection â€” Identity & Code Supply-Chain Risk

Detection Name: COMP01_00_Identity_Repo_Compromise_Detect

Purpose

Provides unified coverage for suspicious identity management (FreeIPA) and repository/exposure risk (self-hosted GitLab), useful for organizations using both. Designed to catch suspicious patterns crossing identity â†’ repo â†’ code/infra.

Detection Logic Sketch
(
  -- FreeIPA anomaly detection
  (index=freeipa_logs event_type="ldap_modify" OR event_type="kerberos_tgt_issued" 
   | where NOT user IN approved_freeipa_admins)
)
OR
(
  -- GitLab suspicious repository activity
  (index=gitlab_audit_logs action IN ("repo_clone","project_export","repo_archive","token_create","permission_change")
    | where NOT user IN approved_gitlab_admins)
)
| table _time host user event_type action repo src_ip dest_ip


Use with your alerting system to trigger mid/high-severity alerts when either identity or repo anomalies occur.

âš™ï¸ Deployment & Operationalization Recommendations

Maintain allow-lists of legitimate admin/service accounts for FreeIPA and GitLab.

Maintain sensitive_repo_list â€” repos containing infra-as-code, credentials, configs, and customer data.

Enable audit logging and log retention on FreeIPA, GitLab, and system logs.

Include network telemetry (firewall, proxy, EDR) to catch data exfil or unusual connections post-compromise.

Establish alert triage workflows: any FreeIPA admin change â‡’ immediately review, any GitLab mass export â‡’ treat as potential exfil + incident.

Rotate all secrets, credentials, tokens, certificates if a breach or anomaly is confirmed â€” especially after a repo breach like recent Red Hat incident.

ðŸ§‘â€ðŸ’» Example: GitLab + FreeIPA Threat-Hunt / IR Workflow

Run composite detection weekly (or on schedule) across FreeIPA + GitLab logs.

For any alert: triage â€” identify user, host, time, action type.

Correlate FreeIPA changes (new principals/tickets) with GitLab events (login, clone, export) within same time window.

If overlap found â€” escalate as potential supply-chain / identity-to-code compromise.

Contain â€” disable suspicious accounts, isolate systems, revoke tokens.

Rotate credentials and secrets across affected environments.

Conduct forensic audit, timeline reconstruction, and impact assessment.

If you like â€” I can generate a GitLab-ready markdown file with this composite detection (with placeholders for allow-lists, repo names, etc.), that you can commit directly to your detection repository.
