LIST OF SPL QUERIES – SOC MONITORING 
Table Of Contents: 
List of Splunk Queries .................................................................................................................................11 1. Query to identify failed login attempts ...............................................................................................11 2. Query to identify potential security threats........................................................................................11 3. Query to identify privilege escalation attempts..................................................................................11 4. Query to identify failed SSH attempts.................................................................................................11 5. Query to identify successful SSH attempts..........................................................................................11 6. Query to identify unusual network traffic ...........................................................................................11 7. Query to identify suspicious processes ...............................................................................................11 8. Query to identify brute force attacks..................................................................................................11 9. Query to identify privilege escalation attempts on Windows systems...............................................12 10. Query to identify abnormal user activity...........................................................................................12 11. Query to identify potential DNS tunneling activity ...........................................................................12 12. Query to identify suspicious PowerShell activity ..............................................................................12 13. Query to identify unusual file access.................................................................................................12 14. Query to identify network port scans................................................................................................12 15. Query to identify suspicious email activity........................................................................................12 16. Query to identify potential data exfiltration .....................................................................................12 17. Query to identify failed VPN attempts ..............................................................................................13 18. Query to identify successful VPN attempts.......................................................................................13 19. Query to identify successful login attempts from new or unknown IP addresses............................13 20. Query to identify potential SQL injection attempts..........................................................................13 21. Query to identify unusual file extensions..........................................................................................13 22. Query to identify potential phishing attacks.....................................................................................13 23. Query to identify traffic to known malicious IP addresses:...............................................................13 24. Query to identify unusual login times: ..............................................................................................13 25. Query to identify privilege escalation attempts on Linux systems ...................................................13 26. Query to identify potential brute force attacks against a specific user ............................................14 27. Query to identify unusual DNS requests ...........................................................................................14 28. Query to identify potential spear-phishing attempts........................................................................14 29. Query to identify potential malware infections................................................................................14 30. Query to identify unusual user activity .............................................................................................14
Nikhil Sharma 
LIST OF SPL QUERIES – SOC MONITORING 
31. Query to identify potential DDoS attacks..........................................................................................14 32. Query to identify potential ransomware activity ..............................................................................14 33. Query to identify potential insider threats:.......................................................................................14 34. Query to identify successful authentication attempts from unknown IP addresses........................15 35. Query to identify potential brute force attacks on a specific service ...............................................15 36. Query to identify successful SSH logins from unusual countries ......................................................15 37. Query to identify potential attempts to exploit known vulnerabilities ............................................15 38. Query to identify potential brute force attacks on a specific user....................................................15 39. Query to identify potential man-in-the-middle attacks....................................................................15 40. Query to identify potential data exfiltration .....................................................................................15 41. Query to identify potential ransomware activity on Windows systems...........................................16 42. Query to identify unusual network traffic patterns ..........................................................................16 43. Query to identify potential brute force attacks on a specific protocol.............................................16 44. Query to identify potential account takeover attempts ...................................................................16 45. Query to identify potential DNS tunneling activity ...........................................................................16 46. Query to identify potential SQL injection attempts on web servers.................................................16 47. Query to identify potential brute force attacks on a specific domain ..............................................16 48. Query to identify potential brute force attacks on a specific application.........................................17 49. Query to identify potential phishing attempts through email attachments.....................................17 50. Query to identify potential exploitation attempts on vulnerable services.......................................17 51. Query to identify potential reconnaissance activity..........................................................................17 52. Query to identify potential cross-site scripting (XSS) attacks on web servers..................................17 53. Query to identify potential privilege escalation attempts ................................................................17 54. Query to identify potential web application attacks.........................................................................17 55. Query to identify potential lateral movement attempts ..................................................................17 56. Query to identify potential unauthorized changes to critical files....................................................18 57. Query to identify potential port scanning activity ............................................................................18 58. Query to identify potential malicious PowerShell activity on Windows systems.............................18 59. Query to identify potential SQL injection attempts on web servers.................................................18 60. Query to identify potential brute force attacks on a specific domain controller .............................18 61. Query to identify potential DDoS attacks..........................................................................................18 62. Query to identify potential web shell activity ...................................................................................18 63. Query to identify potential brute force attacks on a specific network device..................................18
Nikhil Sharma 
LIST OF SPL QUERIES – SOC MONITORING 
64. Query to identify potential privilege escalation attempts on Linux systems....................................19 65. Query to identify potential DNS tunneling activity ...........................................................................19 66. Query to identify potential lateral movement attempts using RDP .................................................19 67. Query to identify potential command and control (C2) traffic .........................................................19 68. Query to identify potential PowerShell Empire activity....................................................................19 69. Query to identify potential ransomware activity ..............................................................................19 70. Query to identify potential malicious traffic from a specific IP address...........................................19 71. Query to identify potential brute force attacks on web applications...............................................19 72. Query to identify potential unauthorized access attempts to sensitive files ...................................20 73. Query to identify potential lateral movement attempts using SMB.................................................20 74. Query to identify potential brute force attacks on SSH servers........................................................20 75. Query to identify potential phishing attacks.....................................................................................20 76. Query to identify potential command injection attempts on web servers.......................................20 77. Query to identify potential lateral movement attempts using WinRM............................................20 78. Query to identify potential brute force attacks on FTP servers........................................................20 79. Query to identify potential privilege escalation attempts on Windows systems.............................20 80. Query to identify potential beaconing activity from a compromised host.......................................21 81. Query to identify potential brute force attacks on SSH servers (failed login attempts)...................21 82. Query to identify potential data exfiltration attempts over HTTP....................................................21 83. Query to identify potential lateral movement attempts using WMI ................................................21 84. Query to identify potential brute force attacks on MSSQL servers ..................................................21 85. Query to identify potential privilege escalation attempts using PowerShell....................................21 86. Query to identify potential brute force attacks on email accounts..................................................21 87. Query to identify potential lateral movement attempts using RDP (successful logins) ...................21 88. Query to identify potential brute force attacks on MSSQL servers (successful logins) ....................22 89. Query to identify potential data exfiltration attempts over FTP ......................................................22 90. Query to identify potential lateral movement attempts using SMB (successful connections) ........22 91. Query to identify potential brute force attacks on RDP....................................................................22 92. Query to identify potential brute force attacks on web applications...............................................22 93. Query to identify potential lateral movement attempts using Remote Registry Service.................22 94. Query to identify potential privilege escalation attempts on Linux systems (sudo usage) ..............22 95. Query to identify potential data exfiltration attempts over DNS .....................................................22 96. Query to identify potential lateral movement attempts using SMB (failed connections)................23
Nikhil Sharma 
LIST OF SPL QUERIES – SOC MONITORING 
97. Query to identify potential brute force attacks on MSSQL servers (failed logins)............................23 98. Query to identify potential data exfiltration attempts over SMTP ...................................................23 99. Query to identify potential lateral movement attempts using NetBIOS...........................................23 100. Query to identify potential brute force attacks on Telnet servers .................................................23 101. Query to identify potential data exfiltration attempts over FTP ....................................................23 102. Query to identify potential lateral movement attempts using WMI (failed connections) .............23 103. Query to identify potential brute force attacks on SSH servers......................................................23 
104. Query to identify potential privilege escalation attempts on Windows systems (services  configuration changes) ............................................................................................................................24 
105. Query to identify potential brute force attacks on SNMP...............................................................24 106. Query to identify potential data exfiltration attempts over HTTP..................................................24 107. Query to identify potential lateral movement attempts using DCOM (failed connections) ..........24 108. Query to identify potential brute force attacks on MySQL servers ................................................24 
109. Query to identify potential privilege escalation attempts on Windows systems (scheduled tasks  creation)...................................................................................................................................................24 
110. Query to identify potential data exfiltration attempts over HTTPS ................................................24 Top 100 Splunk (SPL) Queries for AWS ......................................................................................................25 1. List all EC2 instances:...........................................................................................................................25 2. Get details of S3 bucket access requests:............................................................................................25 3. Monitor CloudFront access logs for specific status codes: .................................................................25 4. Track AWS Lambda function invocations: ...........................................................................................25 5. Monitor AWS CloudTrail activities for specific events: .......................................................................25 6. Get information about EC2 instances running for longer durations:..................................................25 7. Monitor AWS CloudWatch alarms:......................................................................................................25 8. Track changes in AWS Security Groups: ..............................................................................................25 9. Monitor AWS Elastic Load Balancer (ELB) access logs:........................................................................25 10. Get details of AWS RDS database snapshots:....................................................................................25 11. Monitor AWS VPC flow logs for specific traffic patterns:..................................................................25 12. Track AWS CloudFormation stack events:.........................................................................................25 13. Monitor AWS S3 bucket access logs for specific actions:..................................................................26 14. Get details of AWS ECS container instance registrations:.................................................................26 15. Track changes in AWS IAM policies: ..................................................................................................26 16. Monitor AWS CloudFront distribution events:..................................................................................26 17. Get information about AWS Redshift cluster snapshots:..................................................................26
Nikhil Sharma 
LIST OF SPL QUERIES – SOC MONITORING 
18. Track changes in AWS Auto Scaling groups:......................................................................................26 19. Monitor AWS CloudWatch logs for specific log groups:....................................................................26 20. Get details of AWS EMR cluster events:............................................................................................26 21. Monitor AWS Kinesis stream activities:.............................................................................................26 22. Track changes in AWS ECS task definitions: ......................................................................................26 23. Monitor AWS CodeDeploy deployment events: ...............................................................................26 24. Get details of AWS SNS topic subscriptions: .....................................................................................26 25. Track changes in AWS CloudTrail configurations: .............................................................................26 26. Monitor AWS CloudWatch metrics for specific services:..................................................................27 27. Get information about AWS Route 53 DNS queries:.........................................................................27 28. Track changes in AWS S3 bucket policies: .........................................................................................27 29. Monitor AWS EBS volume activities: .................................................................................................27 30. Get details of AWS Lambda function invocations with errors: .........................................................27 31. Track changes in AWS VPC configurations: .......................................................................................27 32. Monitor AWS Glacier vault activities:................................................................................................27 33. Get information about AWS DynamoDB table activities:..................................................................27 34. Track changes in AWS RDS database configurations: .......................................................................27 35. Monitor AWS CloudWatch events for specific rule matches:...........................................................27 36. Get details of AWS Elastic Beanstalk environment events: ..............................................................27 37. Track changes in AWS Redshift cluster configurations: ....................................................................27 38. Monitor AWS Kinesis Firehose delivery stream activities: ................................................................27 39. Get information about AWS SNS topic activities:..............................................................................28 40. Track changes in AWS CloudWatch alarms: ......................................................................................28 41. Monitor AWS CloudFormation stack resource events: .....................................................................28 42. Get details of AWS Glue job runs: .....................................................................................................28 43. Track changes in AWS S3 bucket configurations:..............................................................................28 44. Monitor AWS EFS file system activities: ............................................................................................28 45. Get information about AWS Neptune graph database activities:.....................................................28 46. Track changes in AWS Auto Scaling group configurations: ...............................................................28 47. Monitor AWS CloudWatch logs for specific error patterns:..............................................................28 48. Get details of AWS S3 bucket access logging configurations: ...........................................................28 49. Track changes in AWS Elasticache cluster configurations:................................................................28 50. Monitor AWS Batch job activities:.....................................................................................................28
Nikhil Sharma 
LIST OF SPL QUERIES – SOC MONITORING 
51. Get information about AWS Step Functions state machine executions: ..........................................28 52. Track changes in AWS CloudTrail log file integrity validation: ..........................................................29 53. Monitor AWS CloudWatch metrics for specific RDS instances: ........................................................29 54. Get details of AWS Data Pipeline activities: ......................................................................................29 55. Track changes in AWS S3 bucket object versions:.............................................................................29 56. Monitor AWS GameLift fleet activities:.............................................................................................29 57. Get information about AWS Elastic Transcoder jobs: .......................................................................29 58. Track changes in AWS Cognito user pool configurations: .................................................................29 59. Monitor AWS CloudFront distribution cache statistics: ....................................................................29 60. Get details of AWS Glue crawler activities: .......................................................................................29 61. Track changes in AWS CodeCommit repository configurations:.......................................................29 62. Monitor AWS CloudWatch events for specific target matches:........................................................29 63. Get information about AWS CloudFront distribution activities:.......................................................29 64. Track changes in AWS SNS topic configurations: ..............................................................................29 65. Monitor AWS Elemental MediaConvert job activities:......................................................................30 66. Get details of AWS CloudFormation stack events:............................................................................30 67. Track changes in AWS SageMaker notebook instance configurations: ............................................30 68. Monitor AWS Inspector assessment runs: ........................................................................................30 69. Get information about AWS CodeBuild project activities:................................................................30 70. Track changes in AWS Elasticsearch cluster configurations:.............................................................30 71. Monitor AWS Pinpoint campaign activities:......................................................................................30 72. Get details of AWS WorkSpaces workspace events: .........................................................................30 73. Track changes in AWS Secrets Manager secret configurations: .......................................................30 74. Monitor AWS MediaPackage channel activities:...............................................................................30 75. Get information about AWS CloudHSM cluster activities:................................................................30 76. Track changes in AWS AppStream fleet configurations: ...................................................................30 77. Monitor AWS WAF web ACL activities:..............................................................................................30 78. Get details of AWS Cost and Usage reports: .....................................................................................31 79. Track changes in AWS Device Farm project configurations: .............................................................31 80. Monitor AWS Backup job activities: ..................................................................................................31 81. Get information about AWS MediaLive channel activities: ..............................................................31 82. Track changes in AWS Transit Gateway configurations: ...................................................................31 83. Monitor AWS AppConfig application activities: ................................................................................31
Nikhil Sharma 
LIST OF SPL QUERIES – SOC MONITORING 
84. Get details of AWS Macie findings: ...................................................................................................31 85. Track changes in AWS Transfer for SFTP server configurations:.......................................................31 86. Monitor AWS Resource Access Manager (RAM) activities:...............................................................31 87. Get information about AWS WorkMail organization activities:........................................................31 88. Track changes in AWS Glue job configurations: ................................................................................31 89. Monitor AWS IoT Core device activities: ...........................................................................................31 90. Get details of AWS License Manager license configurations: ...........................................................32 91. Track changes in AWS AppSync API configurations: .........................................................................32 92. Monitor AWS Direct Connect connection activities:.........................................................................32 93. Get information about AWS Elemental MediaPackage VOD activities:............................................32 94. Track changes in AWS Security Hub findings:....................................................................................32 95. Monitor AWS Global Accelerator endpoint activities: ......................................................................32 96. Get details of AWS DataSync task executions: ..................................................................................32 97. Track changes in AWS Amplify application configurations: ..............................................................32 98. Monitor AWS MediaConnect flow activities: ....................................................................................32 99. Get information about AWS Chime meeting activities: ....................................................................32 100. Track changes in AWS Backup plan configurations: ........................................................................32 
Top 100 Splunk queries for Microsoft 365 (formerly known as Office 365).............................................33 1. Get details of Exchange Online mailbox logins:...................................................................................33 2. Track changes in SharePoint Online site permissions: ........................................................................33 3. Monitor OneDrive for Business file activities: .....................................................................................33 4. Get information about Azure Active Directory (AAD) sign-in activities: .............................................33 5. Track changes in Microsoft Teams channel settings: ..........................................................................33 6. Monitor Azure Information Protection (AIP) labeling activities:.........................................................33 7. Get details of SharePoint Online file sharing activities: ......................................................................33 8. Track changes in Microsoft Teams team creation:..............................................................................33 9. Monitor Exchange Online mailbox deletions: .....................................................................................33 10. Get information about Microsoft Defender for Office 365 (formerly Office 365 ATP) detections:..33 11. Track changes in SharePoint Online list item modifications: ............................................................33 12. Monitor Microsoft Teams meeting activities: ...................................................................................33 13. Get details of Azure Active Directory (AAD) user management activities: .......................................34 14. Track changes in Exchange Online mailbox forwarding settings: .....................................................34 15. Monitor SharePoint Online site collection deletions: .......................................................................34
Nikhil Sharma 
LIST OF SPL QUERIES – SOC MONITORING 
16. Get information about Microsoft Teams user activities: ..................................................................34 17. Track changes in Azure Active Directory (AAD) group modifications: ..............................................34 18. Monitor Exchange Online mailbox migrations: .................................................................................34 19. Get details of SharePoint Online site collection creations: ...............................................................34 20. Track changes in Microsoft Teams team membership: ....................................................................34 21. Monitor Azure Active Directory (AAD) password reset activities: ....................................................34 22. Get information about Exchange Online mailbox message activities:..............................................34 23. Track changes in SharePoint Online list modifications:.....................................................................34 24. Monitor Microsoft Teams app installation activities: .......................................................................34 25. Get details of Microsoft Stream video activities: ..............................................................................34 26. Track changes in Azure Active Directory (AAD) application assignments:........................................35 27. Monitor Exchange Online mailbox searches: ....................................................................................35 28. Get information about SharePoint Online site collection deletions: ................................................35 29. Track changes in Microsoft Teams app removals: ............................................................................35 30. Monitor Azure Active Directory (AAD) role assignments:.................................................................35 31. Get details of Exchange Online mailbox message deletions: ............................................................35 32. Track changes in SharePoint Online site collection restorations: .....................................................35 33. Monitor Microsoft Teams channel message activities:.....................................................................35 34. Get information about Azure Active Directory (AAD) user sign-ins:.................................................35 35. Track changes in Exchange Online mailbox permissions:..................................................................35 36. Monitor SharePoint Online site collection creations: .......................................................................35 37. Get details of Microsoft Teams meeting join activities:....................................................................35 38. Track changes in Azure Active Directory (AAD) user license assignments:.......................................35 39. Monitor Exchange Online mailbox folder activities: .........................................................................36 40. Get information about SharePoint Online list item deletions:..........................................................36 41. Track changes in Microsoft Teams team deletion:............................................................................36 42. Monitor Azure Active Directory (AAD) user synchronization activities: ...........................................36 43. Get details of Exchange Online mailbox message deliveries: ...........................................................36 44. Track changes in SharePoint Online site collection sharing settings: ...............................................36 45. Monitor Microsoft Teams app permission activities:........................................................................36 46. Get information about Azure Active Directory (AAD) group membership activities:.......................36 47. Track changes in Exchange Online mailbox forwarding removal:.....................................................36 48. Monitor SharePoint Online list item creations:.................................................................................36
Nikhil Sharma 
LIST OF SPL QUERIES – SOC MONITORING 
49. Get details of Microsoft Teams user role changes: ...........................................................................36 50. Track changes in Azure Active Directory (AAD) user password resets:.............................................36 51. Monitor Exchange Online mailbox folder deletions:.........................................................................36 52. Get information about SharePoint Online site collection restorations: ...........................................37 53. Track changes in Microsoft Teams app installation failures: ............................................................37 54. Monitor Azure Active Directory (AAD) group creation activities: .....................................................37 55. Get details of Exchange Online mailbox message forwarding activities:..........................................37 56. Track changes in SharePoint Online site collection deletion failures:...............................................37 57. Monitor Microsoft Teams channel creation activities: .....................................................................37 58. Get information about Azure Active Directory (AAD) user license removals: ..................................37 59. Track changes in Exchange Online mailbox message deletions:.......................................................37 60. Monitor SharePoint Online list item modifications:..........................................................................37 61. Get details of Microsoft Teams meeting leave activities: .................................................................37 62. Track changes in Azure Active Directory (AAD) user role assignments:............................................37 63. Monitor Exchange Online mailbox folder creations:.........................................................................37 64. Get information about SharePoint Online list item deletions:..........................................................37 65. Track changes in Microsoft Teams team restoration:.......................................................................38 66. Monitor Azure Active Directory (AAD) user deletion activities:........................................................38 67. Get details of Exchange Online mailbox message moves: ................................................................38 68. Track changes in SharePoint Online site collection creations:..........................................................38 69. Monitor Microsoft Teams meeting updates: ....................................................................................38 70. Get information about Azure Active Directory (AAD) user password change activities:..................38 71. Track changes in Exchange Online mailbox folder modifications: ....................................................38 72. Monitor SharePoint Online list item deletions:.................................................................................38 73. Get details of Microsoft Teams meeting recordings: ........................................................................38 74. Track changes in Azure Active Directory (AAD) user sign-in failures: ...............................................38 75. Monitor Exchange Online mailbox message deliveries to external recipients: ................................38 76. Get information about SharePoint Online list item restorations:.....................................................38 77. Track changes in Microsoft Teams app update activities: ................................................................38 78. Monitor Azure Active Directory (AAD) group deletion activities: .....................................................39 79. Get details of Exchange Online mailbox message read activities: ....................................................39 80. Track changes in SharePoint Online site collection modifications:...................................................39 81. Monitor Microsoft Teams user presence changes:...........................................................................39
Nikhil Sharma 
LIST OF SPL QUERIES – SOC MONITORING 
82. Get information about Azure Active Directory (AAD) user license assignments: .............................39 83. Track changes in Exchange Online mailbox litigation holds:.............................................................39 84. Monitor SharePoint Online list item deletions:.................................................................................39 85. Get details of Microsoft Teams channel creation failures: ...............................................................39 86. Track changes in Azure Active Directory (AAD) user license removals: ............................................39 87. Monitor Exchange Online mailbox forwarding modifications: .........................................................39 88. Get information about SharePoint Online site collection restorations: ...........................................39 89. Track changes in Microsoft Teams app installation cancellations: ...................................................39 90. Monitor Azure Active Directory (AAD) group modification activities:..............................................39 91. Get details of Exchange Online mailbox message moves to the Deleted Items folder: ...................40 92. Track changes in SharePoint Online list item creations: ...................................................................40 93. Monitor Microsoft Teams meeting join failures:...............................................................................40 94. Get information about Azure Active Directory (AAD) user role changes:.........................................40 95. Track changes in Exchange Online mailbox folder deletions: ...........................................................40 96. Monitor SharePoint Online site collection creations: .......................................................................40 97. Get details of Microsoft Teams meeting recording deletions:..........................................................40 98. Track changes in Azure Active Directory (AAD) user synchronization failures: ................................40 99. Monitor Exchange Online mailbox folder modifications:..................................................................40 100. Get information about SharePoint Online list item modifications: ................................................40
Nikhil Sharma 
LIST OF SPL QUERIES – SOC MONITORING 
List of Splunk Queries  
1. Query to identify failed login attempts: 
sourcetype=auth* "authentication failure"  
| stats count by user  
| sort -count 
2. Query to identify potential security threats: 
sourcetype=access_* method=POST status=200 
| rex field=_raw "password=(?<password>[^&]+)" 
| eval password_length=length(password) 
| where password_length >= 8 
3. Query to identify privilege escalation attempts: 
sourcetype=linux_secure su* 
| where user!=root AND user!="" 
4. Query to identify failed SSH attempts: 
sourcetype=linux_secure "Failed password for" 
| stats count by src_ip 
| sort -count 
5. Query to identify successful SSH attempts: 
sourcetype=linux_secure "Accepted publickey for" 
| stats count by src_ip 
| sort -count 
6. Query to identify unusual network traffic: 
sourcetype=network_traffic 
| stats sum(bytes) as total_bytes by src_ip, dest_ip 
| where total_bytes > 1000000 
7. Query to identify suspicious processes: 
sourcetype=processes 
| search "lsass.exe" OR "svchost.exe" OR "explorer.exe" 
| stats count by user 
| sort -count 
8. Query to identify brute force attacks: 
sourcetype=access_* | stats count by clientip, action | where action="failure" AND count>=5
Nikhil Sharma 
LIST OF SPL QUERIES – SOC MONITORING 
9. Query to identify privilege escalation attempts on Windows systems: sourcetype="WinEventLog:Security" EventCode=4672 
| eval user_account=mvindex(Account_Name,1) 
| search "Security ID" NOT IN ("SYSTEM","LOCAL SERVICE","NETWORK SERVICE") 
10. Query to identify abnormal user activity: 
sourcetype=access_* action=purchase 
| stats count by clientip, user 
| where count > 50 
11. Query to identify potential DNS tunneling activity: 
sourcetype=dns 
| rex field=answer "data\"\s*:\s*\"(?<data>[^\"]+)\"" 
| eval data_length=len(data) 
| where data_length > 32 AND (data_length % 4) == 0 
12. Query to identify suspicious PowerShell activity: 
sourcetype="WinEventLog:Microsoft-Windows-PowerShell/Operational" EventCode=4103 | eval script_block=mvindex(Message,3) 
| search script_block="*Start-Process*" 
13. Query to identify unusual file access: 
sourcetype=access_* action=file_delete OR action=file_rename 
| stats count by user 
| where count > 10 
14. Query to identify network port scans: 
sourcetype=network_traffic 
| stats count by src_ip, dest_port 
| where count > 100 
15. Query to identify suspicious email activity: 
sourcetype=email  
| search "phishing" OR "malware" OR "suspicious link" 
16. Query to identify potential data exfiltration: 
sourcetype=access_* action=file_download 
| stats count by user, dest_ip, dest_port 
| where count > 10
Nikhil Sharma 
LIST OF SPL QUERIES – SOC MONITORING 
17. Query to identify failed VPN attempts: 
sourcetype=access_* VPN AND action="failure" 
18. Query to identify successful VPN attempts: 
sourcetype=access_* VPN AND action="success" 
19. Query to identify successful login attempts from new or unknown IP addresses: sourcetype=access_* action=login 
| stats count by user, src_ip 
| where count=1 
20. Query to identify potential SQL injection attempts: 
sourcetype=access_* method=POST 
| rex field=_raw "SELECT\s+(?<query>[^;]+)" 
| eval query_length=length(query) 
| where query_length > 50 AND query_length < 100 
21. Query to identify unusual file extensions: 
sourcetype=access_* action=file_upload 
| rex field=file_path ".*\.(?<extension>[^\.]+)" 
| stats count by extension 
| where count > 10 
22. Query to identify potential phishing attacks: 
sourcetype=email 
| search "password" OR "reset" OR "verify" OR "login" 
23. Query to identify traffic to known malicious IP addresses: 
sourcetype=network_traffic dest_ip=malicious_ip 
24. Query to identify unusual login times: 
sourcetype=access_* action=login 
| eval hour=strftime(_time,"%H") 
| stats count by user, hour 
| where count < 3 
25. Query to identify privilege escalation attempts on Linux systems: sourcetype=linux_secure "sudo:" 
| where user!="root" AND user!=""
Nikhil Sharma 
LIST OF SPL QUERIES – SOC MONITORING 
26. Query to identify potential brute force attacks against a specific user: sourcetype=access_* user=username AND action=failure 
| stats count by src_ip 
| where count >= 5 
27. Query to identify unusual DNS requests: 
sourcetype=dns 
| stats count by query 
| where count > 10 
28. Query to identify potential spear-phishing attempts: 
sourcetype=email 
| search "CEO" OR "CFO" OR "Finance" OR "Accounting" OR "Payment" 
29. Query to identify potential malware infections: 
sourcetype=access_* action=file_download 
| rex field=file_path ".*\.(?<extension>[^\.]+)" 
| search extension="exe" OR extension="dll" 
30. Query to identify unusual user activity: 
sourcetype=access_* action=purchase 
| stats count by user 
| where count > 100 
31. Query to identify potential DDoS attacks: 
sourcetype=network_traffic 
| stats sum(bytes) as total_bytes by src_ip 
| where total_bytes > 100000000 
32. Query to identify potential ransomware activity: 
sourcetype=access_* action=file_delete 
| rex field=file_path ".*\.(?<extension>[^\.]+)" 
| search extension="encrypted" OR extension="locked" OR extension="ransom" 
33. Query to identify potential insider threats: 
sourcetype=access_* action=file_upload 
| stats count by user, file_path 
| where count > 10
Nikhil Sharma 
LIST OF SPL QUERIES – SOC MONITORING 
34. Query to identify successful authentication attempts from unknown IP addresses: sourcetype=access_* action=login 
| stats count by src_ip 
| where count >= 5 AND NOT src_ip IN (192.168.0.0/16, 10.0.0.0/8) 
35. Query to identify potential brute force attacks on a specific service: sourcetype=network_traffic service=ssh 
| stats count by src_ip 
| where count >= 10 
36. Query to identify successful SSH logins from unusual countries: sourcetype=access_* action=login service=ssh 
| iplocation src_ip 
| stats count by src_country 
| where count > 10 AND NOT src_country="United States" 
37. Query to identify potential attempts to exploit known vulnerabilities: sourcetype=access_* method=POST 
| rex field=_raw "(?<exploit>CVE-\d{4}-\d+)" 
| stats count by exploit 
| where count > 5 
38. Query to identify potential brute force attacks on a specific user: sourcetype=access_* user=username AND action=failure 
| stats count by src_ip 
| where count >= 5 
39. Query to identify potential man-in-the-middle attacks: 
sourcetype=network_traffic protocol=tcp 
| stats count by dest_ip 
| where count > 100 
40. Query to identify potential data exfiltration: 
sourcetype=access_* action=file_upload 
| stats count by user, file_path 
| where count > 10
Nikhil Sharma 
LIST OF SPL QUERIES – SOC MONITORING 
41. Query to identify potential ransomware activity on Windows systems: sourcetype=WinEventLog:Security EventCode=4663 
| rex field=Object_Name "\\\\.*\\\\(?<filename>.+)" 
| rex field=filename ".*\.(?<extension>[^\.]+)" 
| search extension="encrypted" OR extension="locked" OR extension="ransom" 
42. Query to identify unusual network traffic patterns: 
sourcetype=network_traffic 
| stats count by dest_ip, dest_port 
| where count > 100 AND NOT dest_ip="192.168.0.1" 
43. Query to identify potential brute force attacks on a specific protocol: sourcetype=network_traffic protocol=http 
| stats count by src_ip 
| where count >= 50 
44. Query to identify potential account takeover attempts: sourcetype=access_* action=login 
| stats count by user 
| where count > 10 
45. Query to identify potential DNS tunneling activity: 
sourcetype=dns 
| stats count by query 
| where count > 5 AND NOT match(query, "\.") 
46. Query to identify potential SQL injection attempts on web servers: sourcetype=access_* method=POST uri_path="*.php" 
| rex field=_raw "SELECT\s+(?<query>[^;]+)" 
| eval query_length=length(query) 
| where query_length > 50 AND query_length < 100 
47. Query to identify potential brute force attacks on a specific domain: sourcetype=access_* host=example.com AND action=failure | stats count by src_ip 
| where count >= 10
Nikhil Sharma 
LIST OF SPL QUERIES – SOC MONITORING 
48. Query to identify potential brute force attacks on a specific application: sourcetype=access_* uri_path="/app/login" AND action=failure 
| stats count by src_ip 
| where count >= 5 
49. Query to identify potential phishing attempts through email attachments: sourcetype=email 
| search attachment="*.exe" OR attachment="*.zip" 
50. Query to identify potential exploitation attempts on vulnerable services: sourcetype=network_traffic 
| stats count by src_ip, dest_port 
| where count > 10 AND dest_port IN (22, 3389, 1433, 3306, 8080) 
51. Query to identify potential reconnaissance activity: 
sourcetype=access_* method=GET 
| stats count by uri_path 
| where count > 100 
52. Query to identify potential cross-site scripting (XSS) attacks on web servers: sourcetype=access_* method=POST uri_path="*.php" 
| rex field=_raw "document\.write\('(?<payload>[^']+)'\)" 
| search payload="<script>" 
53. Query to identify potential privilege escalation attempts: sourcetype=access_* action=privilege_escalation 
| stats count by user 
| where count > 5 
54. Query to identify potential web application attacks: 
sourcetype=access_* method=POST uri_path="*.php" 
| rex field=_raw "(?<attack>sql_injection|xss|csrf)" 
| stats count by attack 
| where count > 5 
55. Query to identify potential lateral movement attempts: 
sourcetype=network_traffic protocol=tcp dest_port=445 
| stats count by src_ip, dest_ip 
| where count > 10
Nikhil Sharma 
LIST OF SPL QUERIES – SOC MONITORING 
56. Query to identify potential unauthorized changes to critical files: sourcetype=access_* action=file_write 
| search file_path="*/etc/*" OR file_path="*/var/*" 
57. Query to identify potential port scanning activity: 
sourcetype=network_traffic protocol=tcp 
| stats count by src_ip, dest_port 
| where count > 20 AND NOT dest_port IN (22, 3389, 1433, 3306, 8080) 
58. Query to identify potential malicious PowerShell activity on Windows systems: sourcetype=WinEventLog:Windows PowerShell EventCode=4104 
| search (New-Object System.Net.WebClient).DownloadString OR (Invoke-WebRequest -Uri) 
59. Query to identify potential SQL injection attempts on web servers: sourcetype=access_* method=POST uri_path="*.php" 
| rex field=_raw "SELECT\s+(?<query>[^;]+)" 
| eval query_length=length(query) 
| where query_length > 100 AND query_length < 200 
60. Query to identify potential brute force attacks on a specific domain controller: sourcetype=WinEventLog:Security EventCode=4625 domain_controller="DC01" | stats count by src_ip 
| where count >= 5 
61. Query to identify potential DDoS attacks: 
sourcetype=network_traffic 
| stats count by src_ip 
| where count > 1000 
62. Query to identify potential web shell activity: 
sourcetype=access_* action=command_execution 
| search (echo|print|printf)\s+(base64_decode|eval|gzinflate|str_rot13) 
63. Query to identify potential brute force attacks on a specific network device: sourcetype=cisco:asa 
| stats count by src_ip 
| where count >= 10
Nikhil Sharma 
LIST OF SPL QUERIES – SOC MONITORING 
64. Query to identify potential privilege escalation attempts on Linux systems: sourcetype=access_* action="sudo command" 
| stats count by user 
| where count >= 10 
65. Query to identify potential DNS tunneling activity: 
sourcetype=dns 
| rex field=_raw "\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}#(?<query>.+)\s+\(\d+\)\s+type:  (?<type>.+)\s+class: (?<class>.+)\s+[\d\s]+flags: (?<flags>.+)\s+;[\s\S]+response:\s+no error" | search type="A" AND class="IN" AND flags="rd" 
66. Query to identify potential lateral movement attempts using RDP: sourcetype=WinEventLog:Security EventCode=4624 OR EventCode=4625 | search Logon_Type=10 
67. Query to identify potential command and control (C2) traffic: sourcetype=network_traffic 
| stats count by dest_ip 
| where count > 500 AND NOT dest_ip IN (192.168.0.0/16, 10.0.0.0/8) 
68. Query to identify potential PowerShell Empire activity: 
sourcetype=WinEventLog:Windows PowerShell 
| search (powershell.exe -nop -w hidden -ep bypass -c)|(iex(new-object  net.webclient).downloadstring) 
69. Query to identify potential ransomware activity: 
sourcetype=access_* action=file_write 
| search file_path="*.crypt" OR file_path="*.locky" 
70. Query to identify potential malicious traffic from a specific IP address: sourcetype=network_traffic src_ip=10.1.1.1 
| stats count by dest_ip 
| where count > 10 
71. Query to identify potential brute force attacks on web applications: sourcetype=access_* method=POST uri_path="*.php" 
| stats count by src_ip 
| where count >= 50
Nikhil Sharma 
LIST OF SPL QUERIES – SOC MONITORING 
72. Query to identify potential unauthorized access attempts to sensitive files: sourcetype=access_* action=file_read 
| search file_path="*/etc/shadow" OR file_path="*/etc/passwd" 
73. Query to identify potential lateral movement attempts using SMB: sourcetype=WinEventLog:Security EventCode=5140 
| search Object_Name="*\\ADMIN$" OR Object_Name="*\\C$" 
74. Query to identify potential brute force attacks on SSH servers: 
sourcetype=linux_secure action=invalid 
| stats count by src_ip 
| where count >= 10 
75. Query to identify potential phishing attacks: 
sourcetype=access_* method=POST uri_path="*.php" 
| search form_action="http://www.evilsite.com/login.php" AND (input_password=* OR  input_password=*) 
76. Query to identify potential command injection attempts on web servers: sourcetype=access_* method=POST uri_path="*.php" 
| rex field=_raw "(?<command>cat|ls|dir)\s+(?<argument>[^;]+)" 
| where isnotnull(command) AND isnotnull(argument) 
77. Query to identify potential lateral movement attempts using WinRM: sourcetype=WinEventLog:Microsoft-Windows-WinRM/Operational EventCode=146 | search "winrs: client" AND "is starting a command" AND NOT user="NETWORK SERVICE" AND  NOT user="LocalSystem" 
78. Query to identify potential brute force attacks on FTP servers: 
sourcetype=access_* method=POST uri_path="*/wp-login.php" 
| stats count by src_ip 
| where count >= 20 
79. Query to identify potential privilege escalation attempts on Windows systems: sourcetype=WinEventLog:Security EventCode=4688 
| search (New_Process_Name="*\\runas.exe" OR New_Process_Name="*\\psexec.exe") AND  NOT User="SYSTEM"
Nikhil Sharma 
LIST OF SPL QUERIES – SOC MONITORING 
80. Query to identify potential beaconing activity from a compromised host: sourcetype=network_traffic src_ip=10.1.1.1 
| stats count by dest_port 
| where count > 1000 
81. Query to identify potential brute force attacks on SSH servers (failed login attempts): sourcetype=linux_secure action=failed 
| stats count by src_ip 
| where count >= 10 
82. Query to identify potential data exfiltration attempts over HTTP: sourcetype=access_* action=file_download 
| search uri_path="*.zip" OR uri_path="*.rar" OR uri_path="*.tgz" OR uri_path="*.tar.gz" 
83. Query to identify potential lateral movement attempts using WMI: sourcetype=WinEventLog:Security EventCode=5861 
| search (Operation="ExecQuery" AND QueryLanguage="WQL") OR (Operation="MethodCall"  AND NOT MethodName="GetSecurityDescriptor" AND NOT  
MethodName="SetSecurityDescriptor") 
84. Query to identify potential brute force attacks on MSSQL servers: sourcetype=mssql_access action=failed 
| stats count by src_ip 
| where count >= 10 
85. Query to identify potential privilege escalation attempts using PowerShell: sourcetype=WinEventLog:Microsoft-Windows-PowerShell/Operational EventCode=400 | search "PowerShell pipeline execution details" AND NOT "UserPrincipalName=SYSTEM@*"  AND NOT "UserPrincipalName=NETWORK SERVICE@*" 
86. Query to identify potential brute force attacks on email accounts: sourcetype=exchangeps 
| stats count by src_ip 
| where count >= 10 
87. Query to identify potential lateral movement attempts using RDP (successful logins): sourcetype=WinEventLog:Security EventCode=4624 
| search Logon_Type=10
Nikhil Sharma 
LIST OF SPL QUERIES – SOC MONITORING 
88. Query to identify potential brute force attacks on MSSQL servers (successful logins): sourcetype=mssql_access action=success 
| stats count by src_ip 
| where count >= 10 
89. Query to identify potential data exfiltration attempts over FTP: 
sourcetype=access_* action=file_upload 
| search uri_path="*/ftp" OR uri_path="*/sftp" 
90. Query to identify potential lateral movement attempts using SMB (successful  connections): 
sourcetype=WinEventLog:Security EventCode=5140 
| search Object_Name="*\\ADMIN$" OR Object_Name="*\\C$" 
91. Query to identify potential brute force attacks on RDP: 
sourcetype=WinEventLog:Security EventCode=4625 
| search Logon_Type=10 AND Status="0xC000006D" 
92. Query to identify potential brute force attacks on web applications: sourcetype=access_* method=POST 
| stats count by src_ip, uri_path 
| where count >= 100 
93. Query to identify potential lateral movement attempts using Remote Registry Service: sourcetype=WinEventLog:Security EventCode=4663 
| search Object_Name="*\\REGISTRY\\MACHINE\\SOFTWARE" AND NOT User="SYSTEM" AND  NOT User="NETWORK SERVICE" AND NOT User="LOCAL SERVICE" 
94. Query to identify potential privilege escalation attempts on Linux systems (sudo  usage): 
sourcetype=linux_secure "sudo:" 
95. Query to identify potential data exfiltration attempts over DNS: 
sourcetype=dns 
| search query_type=A AND query !="*.google.com" AND query !="*.facebook.com" AND query  !="*.twitter.com" AND query !="*.microsoft.com"
Nikhil Sharma 
LIST OF SPL QUERIES – SOC MONITORING 
96. Query to identify potential lateral movement attempts using SMB (failed  connections): 
sourcetype=WinEventLog:Security EventCode=5152 
| search Object_Name="*\\ADMIN$" OR Object_Name="*\\C$" AND Status="0xC000006D" 
97. Query to identify potential brute force attacks on MSSQL servers (failed logins): sourcetype=mssql_access action=failed 
| stats count by src_ip 
| where count >= 10 
98. Query to identify potential data exfiltration attempts over SMTP: sourcetype=smtp action=send_message 
| search recipient!="*@gmail.com" AND recipient!="*@yahoo.com" AND  recipient!="*@hotmail.com" AND recipient!="*@aol.com" 
99. Query to identify potential lateral movement attempts using NetBIOS: sourcetype=WinEventLog:Security EventCode=5719 
| search "No Domain Controller is available" OR "This computer was not able to set up a secure  session with a domain controller" 
100. Query to identify potential brute force attacks on Telnet servers: sourcetype=access_* method=POST uri_path="*/telnet" 
| stats count by src_ip 
| where count >= 10 
101. Query to identify potential data exfiltration attempts over FTP: sourcetype=ftp action=putfile 
| stats count by src_ip 
| where count >= 10 
102. Query to identify potential lateral movement attempts using WMI (failed  connections): 
sourcetype=WinEventLog:Security EventCode=5605 
| search Object_Name="*\\ROOT\\CIMV2" AND NOT User="SYSTEM" 
103. Query to identify potential brute force attacks on SSH servers: 
sourcetype=access_* method=POST uri_path="*/ssh" 
| stats count by src_ip 
| where count >= 10
Nikhil Sharma 
LIST OF SPL QUERIES – SOC MONITORING 
104. Query to identify potential privilege escalation attempts on Windows systems  (services configuration changes): 
sourcetype=WinEventLog:Security EventCode=4697 OR EventCode=7045 | search Image_Path="*\\System32\\*" AND NOT User="SYSTEM" 
105. Query to identify potential brute force attacks on SNMP: 
sourcetype=snmptrap 
| stats count by src_ip 
| where count >= 10 
106. Query to identify potential data exfiltration attempts over HTTP: sourcetype=access_* method=POST uri_path="/upload" 
| stats count by src_ip 
| where count >= 10 
107. Query to identify potential lateral movement attempts using DCOM (failed  connections): 
sourcetype=WinEventLog:Security EventCode=10009 
| search "DCOM was unable to communicate with the computer" AND NOT User="SYSTEM" 
108. Query to identify potential brute force attacks on MySQL servers: sourcetype=mysql_access action=failed 
| stats count by src_ip 
| where count >= 10 
109. Query to identify potential privilege escalation attempts on Windows systems  (scheduled tasks creation): 
sourcetype=WinEventLog:Security EventCode=4698 
| search "Task Scheduler service found a misconfiguration" AND NOT User="SYSTEM" 
110. Query to identify potential data exfiltration attempts over HTTPS: sourcetype=ssl method=POST 
| stats count by src_ip, dest_ip 
| where count >= 10
Nikhil Sharma 
LIST OF SPL QUERIES – SOC MONITORING 
Top 100 Splunk (SPL) Queries for AWS  
1. List all EC2 instances: 
source="aws:cloudtrail" eventName="RunInstances" 
2. Get details of S3 bucket access requests: 
source="aws:cloudtrail" eventName=("GetObject" OR "PutObject" OR "DeleteObject")  eventSource="s3.amazonaws.com" 
3. Monitor CloudFront access logs for specific status codes: 
source="aws:cloudfront:accesslogs" | where status_code="404" OR status_code="500" 
4. Track AWS Lambda function invocations: 
source="aws:cloudwatch:logs" message="REPORT" | rex field=_raw "Duration: (?<duration>\S+)" 
5. Monitor AWS CloudTrail activities for specific events: 
source="aws:cloudtrail" eventName=("CreateBucket" OR "CreateUser" OR "DeleteUser") 
6. Get information about EC2 instances running for longer durations: source="aws:cloudwatch:logs" log_stream="YourLogStream" message="YourMessage" 
7. Monitor AWS CloudWatch alarms: 
source="aws:cloudwatch" metric_name="CPUUtilization" alarm_state="ALARM" 
8. Track changes in AWS Security Groups: 
source="aws:config" resourceType="AWS::EC2::SecurityGroup"  
configurationItemStatus="ResourceDeleted" 
9. Monitor AWS Elastic Load Balancer (ELB) access logs: 
source="aws:elb:accesslogs" | stats count by request_ip 
10. Get details of AWS RDS database snapshots: 
source="aws:rds" eventName="CreateDBSnapshot" 
11. Monitor AWS VPC flow logs for specific traffic patterns: 
source="aws:cloudwatchlogs:vpcflow" | where action="ACCEPT" AND dest_port="22" 
12. Track AWS CloudFormation stack events: 
source="aws:cloudformation" | stats count by stack_name
Nikhil Sharma 
LIST OF SPL QUERIES – SOC MONITORING 
13. Monitor AWS S3 bucket access logs for specific actions: 
source="aws:s3:accesslogs" | where action="GetObject" OR action="PutObject" 
14. Get details of AWS ECS container instance registrations: 
source="aws:ecs" eventName="RegisterContainerInstance" 
15. Track changes in AWS IAM policies: 
source="aws:config" resourceType="AWS::IAM::Policy" configurationItemStatus="ResourceDeleted" 
16. Monitor AWS CloudFront distribution events: 
source="aws:cloudfront" | stats count by edge_location 
17. Get information about AWS Redshift cluster snapshots: 
source="aws:redshift" eventName="CreateClusterSnapshot" 
18. Track changes in AWS Auto Scaling groups: 
source="aws:autoscaling" | stats count by auto_scaling_group_name 
19. Monitor AWS CloudWatch logs for specific log groups: 
source="aws:cloudwatchlogs" log_group="YourLogGroup" | stats count by log_stream 
20. Get details of AWS EMR cluster events: 
source="aws:emr" | stats count by cluster_id 
21. Monitor AWS Kinesis stream activities: 
source="aws:kinesis" | stats count by stream_name 
22. Track changes in AWS ECS task definitions: 
source="aws:ecs" | stats count by task_definition_arn 
23. Monitor AWS CodeDeploy deployment events: 
source="aws:codedeploy" | stats count by deployment_id 
24. Get details of AWS SNS topic subscriptions: 
source="aws:sns" eventName="Subscribe" 
25. Track changes in AWS CloudTrail configurations: 
source="aws:cloudtrail" eventName="UpdateTrail"
Nikhil Sharma 
LIST OF SPL QUERIES – SOC MONITORING 
26. Monitor AWS CloudWatch metrics for specific services: 
source="aws:cloudwatch" metric_namespace="AWS/EC2" metric_name="CPUUtilization" 
27. Get information about AWS Route 53 DNS queries: 
source="aws:route53" | stats count by query_name 
28. Track changes in AWS S3 bucket policies: 
source="aws:s3" eventName="PutBucketPolicy" OR eventName="DeleteBucketPolicy" 
29. Monitor AWS EBS volume activities: 
source="aws:ebs" | stats count by volume_id 
30. Get details of AWS Lambda function invocations with errors: source="aws:cloudwatch:logs" message="REPORT" error_message="*" 
31. Track changes in AWS VPC configurations: 
source="aws:config" resourceType="AWS::EC2::VPC" configurationItemStatus="ResourceDeleted" 
32. Monitor AWS Glacier vault activities: 
source="aws:glacier" | stats count by vault_name 
33. Get information about AWS DynamoDB table activities: 
source="aws:dynamodb" | stats count by table_name 
34. Track changes in AWS RDS database configurations: 
source="aws:rds" eventName="ModifyDBInstance" OR eventName="ModifyDBCluster" 
35. Monitor AWS CloudWatch events for specific rule matches: 
source="aws:events" detail-type="Scheduled Event" 
36. Get details of AWS Elastic Beanstalk environment events: 
source="aws:elasticbeanstalk" | stats count by environment_name 
37. Track changes in AWS Redshift cluster configurations: 
source="aws:redshift" eventName="ModifyCluster" OR eventName="CreateCluster" 
38. Monitor AWS Kinesis Firehose delivery stream activities: 
source="aws:kinesisfirehose" | stats count by delivery_stream_name
Nikhil Sharma 
LIST OF SPL QUERIES – SOC MONITORING 
39. Get information about AWS SNS topic activities: 
source="aws:sns" | stats count by topic_name 
40. Track changes in AWS CloudWatch alarms: 
source="aws:cloudwatch" | stats count by alarm_name 
41. Monitor AWS CloudFormation stack resource events: 
source="aws:cloudformation" | stats count by logical_resource_id 
42. Get details of AWS Glue job runs: 
source="aws:glue" | stats count by job_name 
43. Track changes in AWS S3 bucket configurations: 
source="aws:s3" eventName="PutBucketAcl" OR eventName="PutBucketLogging" 
44. Monitor AWS EFS file system activities: 
source="aws:efs" | stats count by file_system_id 
45. Get information about AWS Neptune graph database activities: source="aws:neptune" | stats count by instance_id 
46. Track changes in AWS Auto Scaling group configurations: 
source="aws:autoscaling" eventName="CreateAutoScalingGroup" OR  
eventName="UpdateAutoScalingGroup" 
47. Monitor AWS CloudWatch logs for specific error patterns: 
source="aws:cloudwatchlogs" log_group="YourLogGroup" error_message="*" 
48. Get details of AWS S3 bucket access logging configurations: 
source="aws:s3" eventName="PutBucketLogging" 
49. Track changes in AWS Elasticache cluster configurations: 
source="aws:elasticache" eventName="CreateCacheCluster" OR eventName="ModifyCacheCluster" 
50. Monitor AWS Batch job activities: 
source="aws:batch" | stats count by job_name 
51. Get information about AWS Step Functions state machine executions: source="aws:stepfunctions" | stats count by state_machine_name
Nikhil Sharma 
LIST OF SPL QUERIES – SOC MONITORING 
52. Track changes in AWS CloudTrail log file integrity validation: source="aws:cloudtrail" eventName="AddLogFileValidation" 
53. Monitor AWS CloudWatch metrics for specific RDS instances: source="aws:cloudwatch" metric_namespace="AWS/RDS" metric_name="CPUUtilization" 
54. Get details of AWS Data Pipeline activities: 
source="aws:datapipeline" | stats count by pipeline_name 
55. Track changes in AWS S3 bucket object versions: 
source="aws:s3" eventName="PutObjectVersionAcl" OR eventName="DeleteObjectVersion" 
56. Monitor AWS GameLift fleet activities: 
source="aws:gamelift" | stats count by fleet_id 
57. Get information about AWS Elastic Transcoder jobs: 
source="aws:elastictranscoder" | stats count by job_name 
58. Track changes in AWS Cognito user pool configurations: 
source="aws:cognito" eventName="UpdateUserPool" OR eventName="CreateUserPool" 
59. Monitor AWS CloudFront distribution cache statistics: 
source="aws:cloudfront" | stats sum(cache_hit_count) as Hits, sum(cache_miss_count) as Misses 
60. Get details of AWS Glue crawler activities: 
source="aws:glue" | stats count by crawler_name 
61. Track changes in AWS CodeCommit repository configurations: source="aws:codecommit" eventName="UpdateRepository" OR eventName="CreateRepository" 
62. Monitor AWS CloudWatch events for specific target matches: source="aws:events" detail-type="EC2 Instance State-change Notification" 
63. Get information about AWS CloudFront distribution activities: source="aws:cloudfront" | stats count by distribution_id 
64. Track changes in AWS SNS topic configurations: 
source="aws:sns" eventName="SetTopicAttributes" OR eventName="CreateTopic"
Nikhil Sharma 
LIST OF SPL QUERIES – SOC MONITORING 
65. Monitor AWS Elemental MediaConvert job activities: 
source="aws:mediaconvert" | stats count by job_name 
66. Get details of AWS CloudFormation stack events: 
source="aws:cloudformation" | stats count by stack_name 
67. Track changes in AWS SageMaker notebook instance configurations: source="aws:sagemaker" eventName="CreateNotebookInstance" OR  eventName="UpdateNotebookInstance" 
68. Monitor AWS Inspector assessment runs: 
source="aws:inspector" | stats count by assessment_run_arn 
69. Get information about AWS CodeBuild project activities: source="aws:codebuild" | stats count by project_name 
70. Track changes in AWS Elasticsearch cluster configurations: source="aws:es" eventName="UpdateElasticsearchDomainConfig" OR  eventName="CreateElasticsearchDomain" 
71. Monitor AWS Pinpoint campaign activities: 
source="aws:pinpoint" | stats count by campaign_id 
72. Get details of AWS WorkSpaces workspace events: 
source="aws:workspaces" | stats count by workspace_id 
73. Track changes in AWS Secrets Manager secret configurations: source="aws:secretsmanager" eventName="UpdateSecret" OR eventName="CreateSecret" 
74. Monitor AWS MediaPackage channel activities: 
source="aws:mediapackage" | stats count by channel_id 
75. Get information about AWS CloudHSM cluster activities: source="aws:cloudhsm" | stats count by cluster_id 
76. Track changes in AWS AppStream fleet configurations: 
source="aws:appstream" eventName="UpdateFleet" OR eventName="CreateFleet" 
77. Monitor AWS WAF web ACL activities: 
source="aws:waf" | stats count by web_acl_id
Nikhil Sharma 
LIST OF SPL QUERIES – SOC MONITORING 
78. Get details of AWS Cost and Usage reports: 
source="aws:cur" | stats count by report_name 
79. Track changes in AWS Device Farm project configurations: 
source="aws:devicefarm" eventName="UpdateTestGridProject" OR  
eventName="CreateTestGridProject" 
80. Monitor AWS Backup job activities: 
source="aws:backup" | stats count by backup_job_id 
81. Get information about AWS MediaLive channel activities: 
source="aws:medialive" | stats count by channel_name 
82. Track changes in AWS Transit Gateway configurations: 
source="aws:ec2" eventName="CreateTransitGateway" OR eventName="ModifyTransitGateway" 
83. Monitor AWS AppConfig application activities: 
source="aws:appconfig" | stats count by application_id 
84. Get details of AWS Macie findings: 
source="aws:macie2" | stats count by finding_type 
85. Track changes in AWS Transfer for SFTP server configurations: source="aws:transfer" eventName="UpdateServer" OR eventName="CreateServer" 
86. Monitor AWS Resource Access Manager (RAM) activities: 
source="aws:ram" | stats count by resource_share_arn 
87. Get information about AWS WorkMail organization activities: source="aws:workmail" | stats count by organization_id 
88. Track changes in AWS Glue job configurations: 
source="aws:glue" eventName="UpdateJob" OR eventName="CreateJob" 
89. Monitor AWS IoT Core device activities: 
source="aws:iot" | stats count by device_id
Nikhil Sharma 
LIST OF SPL QUERIES – SOC MONITORING 
90. Get details of AWS License Manager license configurations: 
source="aws:license-manager" | stats count by license_configuration_arn 
91. Track changes in AWS AppSync API configurations: 
source="aws:appsync" eventName="UpdateGraphqlApi" OR eventName="CreateGraphqlApi" 
92. Monitor AWS Direct Connect connection activities: 
source="aws:directconnect" | stats count by connection_id 
93. Get information about AWS Elemental MediaPackage VOD activities: source="aws:mediapackage-vod" | stats count by packaging_group_id 
94. Track changes in AWS Security Hub findings: 
source="aws:securityhub" | stats count by severity 
95. Monitor AWS Global Accelerator endpoint activities: 
source="aws:globalaccelerator" | stats count by endpoint_id 
96. Get details of AWS DataSync task executions: 
source="aws:datasync" | stats count by task_arn 
97. Track changes in AWS Amplify application configurations: 
source="aws:amplify" eventName="UpdateApp" OR eventName="CreateApp" 
98. Monitor AWS MediaConnect flow activities: 
source="aws:mediaconnect" | stats count by flow_arn 
99. Get information about AWS Chime meeting activities: 
source="aws:chime" | stats count by meeting_id 
100. Track changes in AWS Backup plan configurations: 
source="aws:backup" eventName="UpdateBackupPlan" OR eventName="CreateBackupPlan" 
Important Note: Monitor and analyze various AWS services and activities using Splunk. Also adjust the  query parameters and filters as per your specific requirements and environment.
Nikhil Sharma 
LIST OF SPL QUERIES – SOC MONITORING 
Top 100 Splunk queries for Microsoft 365 (formerly known as Office  365)  
1. Get details of Exchange Online mailbox logins: 
sourcetype="o365:management:exchange:activity" operation=MailboxLogin 
2. Track changes in SharePoint Online site permissions: 
sourcetype="o365:management:sharepoint:activity" Operation="SharingSet" ObjectType="Site" 
3. Monitor OneDrive for Business file activities: 
sourcetype="o365:management:onedrive:activity" ObjectType="File" 
4. Get information about Azure Active Directory (AAD) sign-in activities: sourcetype="o365:management:aad:signinlogs" 
5. Track changes in Microsoft Teams channel settings: 
sourcetype="o365:management:teams:activity" Operation="ChannelSettingsChanged" 
6. Monitor Azure Information Protection (AIP) labeling activities: 
sourcetype="o365:management:aip:activity" Activity="SetLabel" 
7. Get details of SharePoint Online file sharing activities: 
sourcetype="o365:management:sharepoint:activity" Operation="SharingSet" ObjectType="ListItem" 
8. Track changes in Microsoft Teams team creation: 
sourcetype="o365:management:teams:activity" Operation="TeamCreated" 
9. Monitor Exchange Online mailbox deletions: 
sourcetype="o365:management:exchange:activity" operation=MailboxDeleted 
10. Get information about Microsoft Defender for Office 365 (formerly Office 365 ATP)  detections: 
sourcetype="o365:management:defender:activity" Activity="ThreatDetection" 
11. Track changes in SharePoint Online list item modifications: 
sourcetype="o365:management:sharepoint:activity" Operation="UpdateListItem" 
12. Monitor Microsoft Teams meeting activities: 
sourcetype="o365:management:teams:activity" ObjectType="OnlineMeeting"
Nikhil Sharma 
LIST OF SPL QUERIES – SOC MONITORING 
13. Get details of Azure Active Directory (AAD) user management activities: sourcetype="o365:management:aad:activity" Category="UserManagement" 
14. Track changes in Exchange Online mailbox forwarding settings: sourcetype="o365:management:exchange:activity" operation=ForwardingSmtpAddressSet 
15. Monitor SharePoint Online site collection deletions: 
sourcetype="o365:management:sharepoint:activity" Operation="DeleteSiteCollection" 
16. Get information about Microsoft Teams user activities: sourcetype="o365:management:teams:activity" ObjectType="User" 
17. Track changes in Azure Active Directory (AAD) group modifications: sourcetype="o365:management:aad:activity" Category="GroupManagement" 
18. Monitor Exchange Online mailbox migrations: 
sourcetype="o365:management:exchange:activity" operation=MailboxMoveStarted OR  operation=MailboxMoveCompleted 
19. Get details of SharePoint Online site collection creations: sourcetype="o365:management:sharepoint:activity" Operation="CreateSiteCollection" 
20. Track changes in Microsoft Teams team membership: 
sourcetype="o365:management:teams:activity" Operation="TeamMembershipChanged" 
21. Monitor Azure Active Directory (AAD) password reset activities: sourcetype="o365:management:aad:activity" Category="PasswordReset" 
22. Get information about Exchange Online mailbox message activities: sourcetype="o365:management:exchange:activity" ObjectType="Message" 
23. Track changes in SharePoint Online list modifications: 
sourcetype="o365:management:sharepoint:activity" Operation="UpdateList" 
24. Monitor Microsoft Teams app installation activities: 
sourcetype="o365:management:teams:activity" Operation="AppInstalled" 
25. Get details of Microsoft Stream video activities: 
sourcetype="o365:management:stream:activity"
Nikhil Sharma 
LIST OF SPL QUERIES – SOC MONITORING 
26. Track changes in Azure Active Directory (AAD) application assignments: sourcetype="o365:management:aad:activity" Category="ApplicationManagement" 
27. Monitor Exchange Online mailbox searches: 
sourcetype="o365:management:exchange:activity" operation=MailboxSearch 
28. Get information about SharePoint Online site collection deletions: sourcetype="o365:management:sharepoint:activity" Operation="DeleteSiteCollection" 
29. Track changes in Microsoft Teams app removals: 
sourcetype="o365:management:teams:activity" Operation="AppRemoved" 
30. Monitor Azure Active Directory (AAD) role assignments: 
sourcetype="o365:management:aad:activity" Category="RoleManagement" 
31. Get details of Exchange Online mailbox message deletions: 
sourcetype="o365:management:exchange:activity" operation=DeleteMessage 
32. Track changes in SharePoint Online site collection restorations: sourcetype="o365:management:sharepoint:activity" Operation="RestoreSiteCollection" 
33. Monitor Microsoft Teams channel message activities: 
sourcetype="o365:management:teams:activity" ObjectType="ChannelMessage" 
34. Get information about Azure Active Directory (AAD) user sign-ins: sourcetype="o365:management:aad:signinlogs" ResultType="0" (OperationType="UserSignIn" OR  OperationType="UserSignInUsingPassword") 
35. Track changes in Exchange Online mailbox permissions: 
sourcetype="o365:management:exchange:activity" operation=MailboxPermissions 
36. Monitor SharePoint Online site collection creations: 
sourcetype="o365:management:sharepoint:activity" Operation="CreateSiteCollection" 
37. Get details of Microsoft Teams meeting join activities: 
sourcetype="o365:management:teams:activity" Operation="JoinMeeting" 
38. Track changes in Azure Active Directory (AAD) user license assignments: sourcetype="o365:management:aad:activity" Category="UserLicenseAssignment"
Nikhil Sharma 
LIST OF SPL QUERIES – SOC MONITORING 
39. Monitor Exchange Online mailbox folder activities: 
sourcetype="o365:management:exchange:activity" ObjectType="Folder" 
40. Get information about SharePoint Online list item deletions: 
sourcetype="o365:management:sharepoint:activity" Operation="DeleteListItem" 
41. Track changes in Microsoft Teams team deletion: 
sourcetype="o365:management:teams:activity" Operation="TeamDeleted" 
42. Monitor Azure Active Directory (AAD) user synchronization activities: sourcetype="o365:management:aad:activity" Category="UserSync" 
43. Get details of Exchange Online mailbox message deliveries: 
sourcetype="o365:management:exchange:activity" operation=DeliverMessage 
44. Track changes in SharePoint Online site collection sharing settings: sourcetype="o365:management:sharepoint:activity" Operation="UpdateSharingSitePolicy" 
45. Monitor Microsoft Teams app permission activities: 
sourcetype="o365:management:teams:activity" Operation="AppPermissionsChanged" 
46. Get information about Azure Active Directory (AAD) group membership activities: sourcetype="o365:management:aad:activity" Category="GroupMembership" 
47. Track changes in Exchange Online mailbox forwarding removal: sourcetype="o365:management:exchange:activity" operation=ForwardingSmtpAddressRemoved 
48. Monitor SharePoint Online list item creations: 
sourcetype="o365:management:sharepoint:activity" Operation="CreateListItem" 
49. Get details of Microsoft Teams user role changes: 
sourcetype="o365:management:teams:activity" Operation="UserRoleChanged" 
50. Track changes in Azure Active Directory (AAD) user password resets: sourcetype="o365:management:aad:activity" Category="PasswordReset" ResultStatus="success" 
51. Monitor Exchange Online mailbox folder deletions: 
sourcetype="o365:management:exchange:activity" operation=DeleteFolder
Nikhil Sharma 
LIST OF SPL QUERIES – SOC MONITORING 
52. Get information about SharePoint Online site collection restorations: sourcetype="o365:management:sharepoint:activity" Operation="RestoreSiteCollection" 
53. Track changes in Microsoft Teams app installation failures: sourcetype="o365:management:teams:activity" Operation="AppInstallationFailed" 
54. Monitor Azure Active Directory (AAD) group creation activities: sourcetype="o365:management:aad:activity" Category="GroupCreation" 
55. Get details of Exchange Online mailbox message forwarding activities: sourcetype="o365:management:exchange:activity" operation=ForwardMessage 
56. Track changes in SharePoint Online site collection deletion failures: sourcetype="o365:management:sharepoint:activity" Operation="DeleteSiteCollectionFailed" 
57. Monitor Microsoft Teams channel creation activities: 
sourcetype="o365:management:teams:activity" Operation="ChannelCreated" 
58. Get information about Azure Active Directory (AAD) user license removals: sourcetype="o365:management:aad:activity" Category="UserLicenseRemoval" 
59. Track changes in Exchange Online mailbox message deletions: sourcetype="o365:management:exchange:activity" operation=PermanentDeleteMessage 
60. Monitor SharePoint Online list item modifications: 
sourcetype="o365:management:sharepoint:activity" Operation="UpdateListItem" 
61. Get details of Microsoft Teams meeting leave activities: 
sourcetype="o365:management:teams:activity" Operation="LeaveMeeting" 
62. Track changes in Azure Active Directory (AAD) user role assignments: sourcetype="o365:management:aad:activity" Category="RoleManagement" 
63. Monitor Exchange Online mailbox folder creations: 
sourcetype="o365:management:exchange:activity" operation=CreateFolder 
64. Get information about SharePoint Online list item deletions: sourcetype="o365:management:sharepoint:activity" Operation="DeleteListItem"
Nikhil Sharma 
LIST OF SPL QUERIES – SOC MONITORING 
65. Track changes in Microsoft Teams team restoration: 
sourcetype="o365:management:teams:activity" Operation="TeamRestored" 
66. Monitor Azure Active Directory (AAD) user deletion activities: 
sourcetype="o365:management:aad:activity" Category="UserDeletion" 
67. Get details of Exchange Online mailbox message moves: 
sourcetype="o365:management:exchange:activity" operation=MoveMessage 
68. Track changes in SharePoint Online site collection creations: 
sourcetype="o365:management:sharepoint:activity" Operation="CreateSiteCollection" 
69. Monitor Microsoft Teams meeting updates: 
sourcetype="o365:management:teams:activity" Operation="UpdateMeeting" 
70. Get information about Azure Active Directory (AAD) user password change activities: sourcetype="o365:management:aad:activity" Category="PasswordChange" 
71. Track changes in Exchange Online mailbox folder modifications: sourcetype="o365:management:exchange:activity" operation=UpdateFolder 
72. Monitor SharePoint Online list item deletions: 
sourcetype="o365:management:sharepoint:activity" Operation="DeleteListItem" 
73. Get details of Microsoft Teams meeting recordings: 
sourcetype="o365:management:teams:activity" ObjectType="OnlineMeetingRecording" 
74. Track changes in Azure Active Directory (AAD) user sign-in failures: sourcetype="o365:management:aad:signinlogs" ResultType="1" (OperationType="UserSignIn" OR  OperationType="UserSignInUsingPassword") 
75. Monitor Exchange Online mailbox message deliveries to external recipients: sourcetype="o365:management:exchange:activity" operation=DeliverMessageExternal 
76. Get information about SharePoint Online list item restorations: sourcetype="o365:management:sharepoint:activity" Operation="RestoreListItem" 
77. Track changes in Microsoft Teams app update activities: 
sourcetype="o365:management:teams:activity" Operation="AppUpdated"
Nikhil Sharma 
LIST OF SPL QUERIES – SOC MONITORING 
78. Monitor Azure Active Directory (AAD) group deletion activities: sourcetype="o365:management:aad:activity" Category="GroupDeletion" 
79. Get details of Exchange Online mailbox message read activities: sourcetype="o365:management:exchange:activity" operation=ReadMessage 
80. Track changes in SharePoint Online site collection modifications: sourcetype="o365:management:sharepoint:activity" Operation="UpdateSiteCollection" 
81. Monitor Microsoft Teams user presence changes: 
sourcetype="o365:management:teams:activity" Operation="UserPresenceChanged" 
82. Get information about Azure Active Directory (AAD) user license assignments: sourcetype="o365:management:aad:activity" Category="UserLicenseAssignment" 
83. Track changes in Exchange Online mailbox litigation holds: 
sourcetype="o365:management:exchange:activity" operation=MailboxLitigationHold 
84. Monitor SharePoint Online list item deletions: 
sourcetype="o365:management:sharepoint:activity" Operation="DeleteListItem" 
85. Get details of Microsoft Teams channel creation failures: 
sourcetype="o365:management:teams:activity" Operation="ChannelCreationFailed" 
86. Track changes in Azure Active Directory (AAD) user license removals: sourcetype="o365:management:aad:activity" Category="UserLicenseRemoval" 
87. Monitor Exchange Online mailbox forwarding modifications: sourcetype="o365:management:exchange:activity" operation=ForwardingSmtpAddressModified 
88. Get information about SharePoint Online site collection restorations: sourcetype="o365:management:sharepoint:activity" Operation="RestoreSiteCollection" 
89. Track changes in Microsoft Teams app installation cancellations: sourcetype="o365:management:teams:activity" Operation="AppInstallationCancelled" 
90. Monitor Azure Active Directory (AAD) group modification activities: sourcetype="o365:management:aad:activity" Category="GroupModification"
Nikhil Sharma 
LIST OF SPL QUERIES – SOC MONITORING 
91. Get details of Exchange Online mailbox message moves to the Deleted Items folder: sourcetype="o365:management:exchange:activity" operation=MoveMessageToDeletedItems 
92. Track changes in SharePoint Online list item creations: 
sourcetype="o365:management:sharepoint:activity" Operation="CreateListItem" 
93. Monitor Microsoft Teams meeting join failures: 
sourcetype="o365:management:teams:activity" Operation="JoinMeetingFailed" 
94. Get information about Azure Active Directory (AAD) user role changes: sourcetype="o365:management:aad:activity" Category="RoleManagement" 
95. Track changes in Exchange Online mailbox folder deletions: 
sourcetype="o365:management:exchange:activity" operation=DeleteFolder 
96. Monitor SharePoint Online site collection creations: 
sourcetype="o365:management:sharepoint:activity" Operation="CreateSiteCollection" 
97. Get details of Microsoft Teams meeting recording deletions: 
sourcetype="o365:management:teams:activity" ObjectType="OnlineMeetingRecording" 
98. Track changes in Azure Active Directory (AAD) user synchronization failures: sourcetype="o365:management:aad:activity" Category="UserSync" ResultStatus="failure" 
99. Monitor Exchange Online mailbox folder modifications: 
sourcetype="o365:management:exchange:activity" operation=UpdateFolder 
100. Get information about SharePoint Online list item modifications: sourcetype="o365:management:sharepoint:activity" Operation="UpdateListItem" 
Important Note: Monitor and analyze various Microsoft 365 activities in Splunk. Also adjust the queries  based on your specific configuration and naming conventions.
Nikhil Sharma 
