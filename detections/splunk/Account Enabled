index=winevent_security EventCode=4722
| eval Account_Name=coalesce(TargetUserName, user)
| table _time, host, Account_Name, TargetDomainName, SubjectUserName, SubjectDomainName, ComputerName, Account_Name



index=winevent_security EventCode=4722
| eval Enabled_Account=TargetUserName, Enabling_User=SubjectUserName
| table _time, host, Enabled_Account, Enabling_User, TargetDomainName, SubjectDomainName, ComputerName, src, dest
| sort -_time


index=winevent_security EventCode=4722 NOT TargetUserName IN ("Administrator", "svc_account*")
| eval Enabled_Account=TargetUserName, Enabling_User=SubjectUserName
| table _time, host, Enabled_Account, Enabling_User, TargetDomainName, SubjectDomainName, ComputerName

Example Alert Description (for SOC Documentation)

Alert Name: Account Enabled (EventCode 4722)
Description: Detects when any user account is enabled in Active Directory. This may indicate privilege escalation or reactivation of a compromised account.
MITRE ATT&CK Mapping: T1078 â€“ Valid Accounts
Severity: Medium
Recommended Action: Validate whether the enabling user action was authorized. Review recent activity for the re-enabled account.
