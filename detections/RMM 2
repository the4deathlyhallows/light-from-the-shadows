ðŸ›°ï¸ PART 1 â€” RMM THREAT HUNT PLAN (FULL, PROFESSIONAL VERSION)
ðŸŽ¯ Hunt Objective

Identify unauthorized or malicious use of RMM tools â€” AnyDesk, TeamViewer, ScreenConnect, Atera, Splashtop, Zoho Assist, LogMeIn Rescue â€” used for:

Initial access

Lateral movement

Persistence

Hands-on-keyboard activity

Ransomware deployment

ðŸ”Ž HYPOTHESIS-DRIVEN THREAT HUNTS (12 total)

Each hypothesis includes what to look for + example queries.

H1 â€” Unauthorized RMM installed on endpoints

Attackers frequently silently deploy AnyDesk, ScreenConnect, or Splashtop using PowerShell.

Indicators

New installation events

Process executed from %TEMP% or %APPDATA%

Run by user accounts outside IT

Splunk Hunt Query
index=sysmon
(Image="*AnyDesk.exe" OR Image="*ScreenConnect*" OR Image="*TeamViewer*" OR Image="*Splashtop*")
| where NOT (dest IN approved_rmm_hosts)
| table _time Computer User Image ParentImage CommandLine

H2 â€” RMM launched from unusual directories

Legitimate installs occur in Program Files. Threat actors hide them in:

%TEMP%

%APPDATA%\Roaming

%ProgramData%\RandomFolder\

Query
index=sysmon process_name IN ("AnyDesk.exe","TeamViewer.exe","ScreenConnect.ClientService.exe")
| where like(process_path, "%AppData%") OR like(process_path, "%temp%") OR like(process_path, "%ProgramData%")

H3 â€” RMM executed by suspicious parents

High-risk parents:

powershell.exe

cmd.exe

msiexec.exe

winword.exe (phishing macro)

outlook.exe (phishing)

Query
index=sysmon 
(Image="*AnyDesk*" OR Image="*ScreenConnect*" OR Image="*TeamViewer*")
ParentImage IN ("*powershell.exe","*cmd.exe","*msiexec.exe","*winword.exe","*outlook.exe")

H4 â€” Newly created SYSTEM-level RMM services

Attackers often install RMM as persistent Windows services.

Look for:

AnyDesk

"ScreenConnect Client (XXXX)"

"TeamViewer"

"SplashtopRemoteService"

Query
index=winEventLog EventCode=4697
| where ServiceName IN ("AnyDesk","TeamViewer","ScreenConnect*","Splashtop*")

H5 â€” RMM activity after phishing

Correlation: phishing email â†’ user executes RMM payload.

Query
index=ms_o365 OR index=email_logs
(subject="password" OR subject="verify" OR subject="invoice" OR attachment="*.exe")
| join user
    [ search index=sysmon Image="*AnyDesk.exe" OR Image="*ScreenConnect*" earliest=-24h ]

H6 â€” RMM beaconing to known infrastructure

Look for outbound traffic to:

*.anydesk.com

*.teamviewer.com

*.screenconnect.com

*.splashtop.com

Query
index=network OR sourcetype=pan:traffic
dest_domain IN ("*.anydesk.com","*.teamviewer.com","*.screenconnect.com","*.splashtop.com")

H7 â€” RMM on critical servers

No RMM should exist on:

Domain Controllers

File servers

Finance/SOX servers

Database servers

Query
index=sysmon Image IN ("AnyDesk.exe","TeamViewer.exe","ScreenConnect.ClientService.exe")
| lookup critical_servers host OUTPUT server_role
| where isnotnull(server_role)

H8 â€” Multiple RMM tools on same host

Huge red flag â€” attackers stack tools.

Query
| tstats count from datamodel=Endpoint.Processes 
  where Processes.process_name IN ("AnyDesk.exe","TeamViewer.exe","ScreenConnect*","Splashtop*","ZohoAssist*")
  by Processes.dest Processes.process_name
| stats count(process_name) as tool_count values(process_name) as tools by dest
| where tool_count > 1

H9 â€” RMM used outside business hours

Attackers operate at night/weekends.

Query
index=sysmon Image IN ("AnyDesk.exe","TeamViewer.exe","ScreenConnect.ClientService.exe")
| eval hour=strftime(_time,"%H")
| where hour<6 OR hour>20

H10 â€” RMM file transfers or clipboard operations

Look for TeamViewer/AnyDesk file transfer events.

Behavior

Outbound ZIPs, EXEs, PS1 files

Clipboard sharing events

Query Idea

(Varies by logging solution â€” EDR is best source.)

index=edr EventType="file_transfer" AND process_name IN ("AnyDesk.exe","TeamViewer.exe")

H11 â€” RMM used immediately before ransomware detonation

Over 60% of ransomware intrusions use RMM for staging.

Query
index=sysmon Image="*AnyDesk*" OR Image="*ScreenConnect*"
| join host
    [ search index=sysmon Image="*\\*.exe" CommandLine="*shadowcopy*" OR CommandLine="*vssadmin delete*" ]

H12 â€” Beaconing to unknown ScreenConnect servers

ScreenConnect is often self-hosted by attackers on cheap VPS.

Query
index=network dest_port IN (8040,8041,8042,8043)
| lookup known_screenconnect_servers ip OUTPUT known
| where isnull(known)
