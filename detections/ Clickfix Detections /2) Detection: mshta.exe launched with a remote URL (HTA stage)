let lookback = 14d;
DeviceProcessEvents
| where TimeGenerated >= ago(lookback)
| where FileName in~ ("mshta.exe")
| extend Cmd = tolower(tostring(ProcessCommandLine))
| where Cmd has "http://" or Cmd has "https://"
| where Cmd has ".hta" or Cmd has "mshta "  // many use URL without explicit .hta; keep both
| project TimeGenerated, DeviceName, AccountName, FileName, ProcessCommandLine,
          InitiatingProcessFileName, InitiatingProcessCommandLine
| order by TimeGenerated desc
