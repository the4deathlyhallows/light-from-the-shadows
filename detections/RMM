Skip to content
Chat history


You said:
gadrkt'let
ChatGPT said:
It looks like ‚Äúgadrkt'let‚Äù might be a typo or something that autocorrect scrambled.

A few possibilities:

Did you mean to type ‚Äúgot it, let‚Äôs‚Ä¶‚Äù?

Or ‚Äúgadget let‚Ä¶‚Äù?

Or ‚Äúgo ahead ‚Äî let‚Ä¶‚Äù?

Tell me what you were trying to say and I‚Äôll pick it up from there.

You said:
what ports are commonly used used with RMM tools such as atera, screen connect, etc.
ChatGPT said:
Below is a clean, accurate list of commonly used ports for major RMM (Remote Monitoring & Management) tools like Atera, ConnectWise ScreenConnect, TeamViewer, AnyDesk, GoToAssist, Splashtop, etc.
This gives you solid detection-engineering context and helps build port-based correlations or baselines.

üîê Common Ports Used by RMM / Remote Support Tools

https://images.surferseo.art/6de24fb1-022f-4509-a565-573820ee28c0.png?utm_source=chatgpt.com

https://wiki.classe.cornell.edu/pub/Computing/ScreenConnect/igp_63d00e6351d5de6c3c0c8f14a08adfa5_Selection_139.png?utm_source=chatgpt.com

https://support.atera.com/hc/article_attachments/15646783292444?utm_source=chatgpt.com
üüß Atera
Atera agents usually communicate outbound only (no inbound ports needed on the endpoint).

HTTPS outbound ‚Üí TCP 443 (primary)

Secondary outbound:

TCP 80 (fallback)

TCP 5671‚Äì5672 (AMQP messaging)

TCP 8800‚Äì8806 (remote access modules depending on Splashtop / AnyDesk configuration)

Atera remote access uses Splashtop or AnyDesk, so see those below.

üîµ ConnectWise ScreenConnect (formerly ScreenConnect)
ScreenConnect is very identifiable by its ports.

Server Ports

TCP 8040‚Äì8042 ‚Üí Relay & web interface

TCP 8043 ‚Üí HTTPS Web UI

TCP 8040 ‚Üí SignalR / agent connectivity

Client/Agent Outbound Ports

TCP 443 (cloud-hosted systems mostly use 443 only)

TCP 8040 (self-hosted relay)

üü• AnyDesk
Common in many RMM bundles (Atera optional addon).

TCP 80, 443, 6568 ‚Üí outbound

UDP 50001

Sometimes TCP 7070 (relay servers)

Noteworthy for detection:
AnyDesk EXEs often beacon over 443 but maintain fallback on 80 & 6568.

üü¶ TeamViewer
Very noisy and easy to fingerprint.

TCP 5938 ‚Üí primary outbound (TeamViewer proprietary protocol)

TCP 443 & 80 ‚Üí fallback

UDP 5938 ‚Üí performance channel

üü© Splashtop
Frequently bundled with Atera, NinjaOne, Zoho Assist.

TCP 443 ‚Üí primary

TCP 80 ‚Üí fallback

TCP 6783‚Äì6785 ‚Üí remote session channels

UDP 20803, 7353 ‚Üí service discovery / performance

üü™ GoToAssist / LogMeIn Rescue
TCP 8200‚Äì8201

TCP 443

TCP 80

üü´ Zoho Assist
TCP 443

TCP 80

TCP 8443 (relay)

üéØ Summary Table ‚Äî RMM Tool Port Signatures
RMM Tool	Common Ports	Notes
Atera	443, 80, 5671‚Äì5672, 8800‚Äì8806	Uses Splashtop/AnyDesk for remote access
ScreenConnect	8040‚Äì8043, 443	Clear signature for self-hosted
AnyDesk	80, 443, 6568, UDP 50001	Frequent in covert IT support abuse
TeamViewer	5938, 443, 80	Port 5938 is a strong indicator
Splashtop	443, 80, 6783‚Äì6785, UDP 20803	Often tied to RMMs
GoToAssist	8200‚Äì8201, 443, 80	
Zoho Assist	443, 80, 8443	
üîé Detection Engineering Insight
1Ô∏è‚É£ Port-only detection is NOT enough
Threat actors frequently abuse legitimate RMM tools (Living-off-the-land remote access).
Ports overlap with normal HTTPS traffic.

2Ô∏è‚É£ Stronger signals:
New binary in C:\ProgramData\‚Ä¶ linked to RMM tools

Unsigned or mismatched publisher for TeamViewer/AnyDesk

Service installation events:

sc create

new services: AnyDesk, TeamViewer, ScreenConnect Client (xxxxxxxxxx)

Network beacons to known RMM cloud domains

Interactive logon events from remote session accounts

Unusual parent/child process chains (PowerShell ‚Üí RMM bootstrapper)

3Ô∏è‚É£ Use this for threat hunting or correlation
Baseline:

Which RMM tools are approved?

What are the expected ports and domains?

Anything new or running outside enterprise install paths is suspicious.

‚öôÔ∏è If you want, I can build:
‚úÖ A Splunk correlation search
‚úÖ A YARA-L detection for ‚ÄúUnauthorized RMM Activity‚Äù
‚úÖ A GitLab-ready detection card (like you asked earlier)
‚úÖ Indicators for abused RMM installs
Just tell me.

You said:
yes
ChatGPT said:
Great ‚Äî I'll build you a GitLab-ready detection card for Unauthorized / Suspicious RMM Activity, covering Atera, ScreenConnect, AnyDesk, TeamViewer, Splashtop, Zoho Assist, LogMeIn/GoToAssist**.

Below is clean, production-ready documentation you can drop into GitLab as an issue or detection artifact.

üõ°Ô∏è DETECTION CARD: Unauthorized Remote Monitoring & Management (RMM) Activity
Detection Name:
DE02_04_Unauthorized_RMM_Activity

Tactic:
TA0011 ‚Äì Command & Control
TA0008 ‚Äì Lateral Movement
TA0006 ‚Äì Credential Access (when credential harvesting follows RMM deployment)

Technique(s):
T1219 ‚Äì Remote Access Software

T1569 ‚Äì System Services (service install)

T1105 ‚Äì Ingress Tool Transfer

T1071.001 ‚Äì Web Protocols (HTTPS beaconing)

1. OVERVIEW
Remote Monitoring & Management (RMM) tools‚Äîsuch as Atera, ScreenConnect, AnyDesk, TeamViewer, Splashtop, Zoho Assist, and LogMeIn Rescue‚Äîare commonly abused by threat actors for persistent, stealthy, interactive access to compromised systems.
This detection identifies unauthorized installations, new beacons, suspicious service creations, or abnormal network patterns related to RMM tools.

2. COMMON PORTS OBSERVED
These are the network ports most associated with RMM activity (baseline against your enterprise-approved list):

Tool	Ports	Notes
Atera	443, 80, 5671‚Äì5672, 8800‚Äì8806	Uses AnyDesk/Splashtop
ScreenConnect	8040‚Äì8043, 443	Clear fingerprint for self-hosted
AnyDesk	80, 443, 6568, UDP 50001	Often abused
TeamViewer	5938 (primary), 443, 80	5938 = very strong signal
Splashtop	443, 80, 6783‚Äì6785, UDP 20803	Remote session channels
Zoho Assist	443, 80, 8443	Relays
LogMeIn Rescue / GoToAssist	8200‚Äì8201, 443, 80	Enterprise tech support
3. DATA SOURCES
Sysmon (Process Create, Network Connect, File Create)

Windows Security Logs (Service Install Event 4697, Scheduled Tasks)

EDR telemetry

Google SecOps / Chronicle (PROCESS_LAUNCH, NETWORK_HTTP, DNS_REQUEST)

Splunk Endpoint Datamodel

4. BEHAVIORAL INDICATORS
A. Suspicious Process Execution
Processes commonly abused:

AnyDesk.exe  
TeamViewer.exe  
tv_w32.exe  
tv_x64.exe  
ScreenConnect.ClientService.exe  
AteraAgent.exe  
SplashtopRemoteService.exe  
ZohoAssist*.exe  
LMIRescue*.exe
Red flags:

Parent process = PowerShell, cmd, wscript, msiexec, or office apps

Executed from unusual directories:

%TEMP%

Downloads

C:\Users\<user>\AppData\Roaming\

ProgramData\<random>\

B. Suspicious Service Installation
Look for:

sc.exe create

New services named:

AnyDesk

TeamViewer

ScreenConnect Client (XXXXXX)

AteraAgent

SplashtopRemoteService

C. Suspicious Network Activity
Outbound connections to:

Tool	Common Domains
Atera	*.atera.com, *.atera.ai
ScreenConnect	*.screenconnect.com, custom self-hosted domains
AnyDesk	*.anydesk.com
TeamViewer	*.teamviewer.com
Splashtop	*.splashtop.com
Zoho Assist	*.zohoassist.com
LogMeIn	*.logmeinrescue.com
5. SPLUNK CORRELATION SEARCH (Endpoint + Network)
| tstats summariesonly=t count min(_time) as firstTime max(_time) as lastTime 
  from datamodel=Endpoint.Processes 
  where Processes.process IN ("*AnyDesk*", "*TeamViewer*", "*ScreenConnect*", 
                              "*Splashtop*", "*ZohoAssist*", "*Atera*")
  OR Processes.process_path IN ("*AnyDesk.exe","*TeamViewer.exe","*AteraAgent.exe",
                                "*Splashtop*.exe","*ScreenConnect*.exe")
  by Processes.dest Processes.user Processes.process_name Processes.process_path 
     Processes.parent_process_name Processes.parent_process_path
| `drop_dm_object_name(Processes)`
| lookup approved_rmm_tools tool_name AS process_name OUTPUT tool_status
| where isnull(tool_status) OR tool_status!="approved"
| table dest user process_name process_path parent_process_name firstTime lastTime
6. GOOGLE SECOPS / CHRONICLE YARA-L RULE
rule NL02_01_Unauthorized_RMM_Activity
{
    meta:
        author = "Auto"
        description = "Detects execution of unauthorized RMM remote access tools"
        tactic = "TA0011"
        technique = "T1219"
        severity = "High"
        created = "2025-12-08"

    events:
        $p.metadata.event_type = PROCESS_LAUNCH
        $n.metadata.event_type = NETWORK_HTTP or NETWORK_DNS

    condition:
        // Process Indicators
        any of (
            re.regex($p.target.process.file.name, "(?i)anydesk"),
            re.regex($p.target.process.file.name, "(?i)teamviewer|tv_w32|tv_x64"),
            re.regex($p.target.process.file.name, "(?i)screenconnect"),
            re.regex($p.target.process.file.name, "(?i)splashtop"),
            re.regex($p.target.process.file.name, "(?i)zohoassist"),
            re.regex($p.target.process.file.name, "(?i)atera")
        )
        and

        // Not an allowed enterprise tool
        not asset.in_allowed_rmm_list($p.principal.asset.id)
}
(If you want, I can wire the custom function using list-based allowlists.)

7. RESPONSE PLAYBOOK (CONDENSED)
Confirm if tool is approved

Check IT asset list

Validate with system owner

If unauthorized:

Contain host (EDR isolate)

Identify installation time, user context

Gather:

New services

Scheduled tasks

Download chains (PowerShell ‚Üí MSI ‚Üí RMM)

Remote IPs, domains

Hunt for lateral movement

Look for credential theft steps following RMM deployment

Eradicate & recover

Remove service/binaries

Reset passwords

Reimage if post-exploitation observed

Want Level-2, Level-3 detection cards?
I can generate:

Atera-specific detection card

ScreenConnect self-hosted exploitation detection

AnyDesk covert install detection

TeamViewer abuse detection

Baseline query for your environment

GitLab issue templates for detections

Just tell me which tool you want next or if you want all of them standardized.

You said:
yrd
ChatGPT said:

Stopped thinking
You said:
yes
ChatGPT said:
Got it ‚Äî you want ALL of them standardized.
I‚Äôll produce a full GitLab-ready detection pack, one card per RMM tool plus a unified master correlation you can deploy across Splunk, Google SecOps, or your GitLab pipeline.

Before I generate the full pack (which will be long and highly structured), I need one clarification so the output perfectly matches your workflow:

‚ùì Which format do you want the RMM detection pack delivered in?
Choose A, B, or C:

A) GitLab Issue Templates (one per detection)
Detection Title

Summary

MITRE Mapping

Data Required

Detection Logic (Splunk + YARA-L)

False Positives

Validation Steps

Response Guidance

Labels (Phase: In Progress, Peer Review, etc.)

‚úî Perfect for engineering boards
‚úî Used by many SOC/Detection teams in GitLab
‚úî Easy to copy/paste into GitLab Issues

B) GitLab Repository Markdown Files (detections/rmm/‚Ä¶)
You get:

/detections/rmm/atera.md
/detections/rmm/screenconnect.md
/detections/rmm/anydesk.md
/detections/rmm/teamviewer.md
/detections/rmm/splashtop.md
/detections/rmm/zohoassist.md
/detections/rmm/logmein_rescue.md
/detections/rmm/master_unauthorized_rmm.md
‚úî Great for version-controlled detections
‚úî Clean hierarchical structure
‚úî Ready for GitOps workflows

C) Detection Bundle + Correlation Suite (Highest Detail)
Includes EVERYTHING:

GitLab issue templates

GitLab markdown files

Splunk correlations

Google SecOps YARA-L rules

Domain IOCs

Port IOCs

Behavioral IOCs

Approved vs unauthorized logic

PBQ-style validation cases

Engineering review checklist

Detection test payloads

Risk scoring (CVSS-like internal scoring)

‚úî This is the enterprise-grade bundle
‚úî Best if you want a full detection engineering pipeline
‚úî Perfect for your GitLab phases: In Progress ‚Üí Needs Peer Review ‚Üí QA ‚Üí Ready ‚Üí Released

üëâ Which one do you want me to generate: A, B, or C?
If you want everything, choose C.

You said:
all
ChatGPT said:

Thought for 7s
Alright, let‚Äôs do everything: issues, markdown repo structure, Splunk + YARA-L, ports/domains, behavior, and a master ‚Äúunauthorized RMM‚Äù correlation.

I‚Äôll keep things copy/pasteable and structured so you can drop this straight into GitLab.

0. Repo Layout (Markdown Structure)
You can structure your GitLab repo like this:

detections/
  rmm/
    atera.md
    screenconnect.md
    anydesk.md
    teamviewer.md
    splashtop.md
    zoho_assist.md
    logmein_rescue.md
    master_unauthorized_rmm.md
  templates/
    gitlab_issue_detection_template.md
Each *.md below is meant to live under detections/rmm/.

1. Generic GitLab Detection Issue Template
detections/templates/gitlab_issue_detection_template.md

# Detection: {{DETECTION_NAME}}

**Tactic(s):** {{TACTICS}}  
**Technique(s):** {{TECHNIQUES}}  

## 1. Summary

{{SHORT_HUMAN_SUMMARY}}

## 2. Rationale

- Why this matters:
  - {{WHY_THIS_IS_IMPORTANT}}
- Threats / abuse cases:
  - {{THREAT_CASES}}

## 3. Data Requirements

- Logs:
  - {{LOG_SOURCES}} (e.g., Sysmon, EDR, Google SecOps, Cloud logs)
- Fields:
  - {{KEY_FIELDS}}

## 4. Detection Logic

### 4.1 Splunk (tstats or raw)

```splunk
{{SPLUNK_QUERY}}
4.2 Google SecOps / Chronicle (YARA-L)
{{YARA_L_RULE}}
5. Tuning & False Positives
Expected legit use cases:

{{APPROVED_USE}}

Suggested filters:

{{WHITELIST_CONDITIONS}}

6. Validation
Steps to validate this detection:

{{STEPS}}

7. Response Guidance
Containment:

{{CONTAINMENT_STEPS}}

Investigation:

{{INVESTIGATION_STEPS}}

Recovery:

{{RECOVERY_STEPS}}

8. Metadata
Detection Owner: @{{OWNER}}

Status: In Progress | Needs Peer Review | Ready | Released

Labels:

tactic::{{TACTIC_TAG}}

technique::{{TECHNIQUE_TAG}}

phase::{{PHASE}}

rmm


For each RMM below, you can either:

- Make a **GitLab issue** from this template, or  
- Keep it as markdown in the repo.

---

## 2. Master Detection ‚Äì Unauthorized RMM Activity

### 2.1 Markdown: `detections/rmm/master_unauthorized_rmm.md`

```markdown
# DE02_04_Unauthorized_RMM_Activity

**Tactics:**  
- TA0011 ‚Äì Command and Control  
- TA0008 ‚Äì Lateral Movement  
- TA0006 ‚Äì Credential Access (secondary)

**Techniques:**  
- T1219 ‚Äì Remote Access Software  
- T1569 ‚Äì System Services  
- T1105 ‚Äì Ingress Tool Transfer  
- T1071.001 ‚Äì Web Protocols

---

## 1. Summary

Detects **unauthorized installations or use of RMM tools** (Atera, ScreenConnect, AnyDesk, TeamViewer, Splashtop, Zoho Assist, LogMeIn Rescue) based on process names, install locations, service creation, and network behavior. Focus is on systems where RMM software is **not part of the approved inventory**.

---

## 2. Data Requirements

- Sysmon / EDR process & network telemetry
- Windows Security logs (service creation, scheduled tasks)
- Google SecOps / Chronicle PROCESS_LAUNCH, NETWORK_HTTP, DNS_REQUEST
- Asset inventory / allow-list of **approved RMM tools** and hosts

Key fields:

- `process_name`, `process_path`, `parent_process_name`
- `dest`, `dest_ip`, `url`, `domain`
- `service_name`, `service_path`
- `asset_id`, `host`, `user`

---

## 3. Indicators

### 3.1 Typical RMM Binaries

- AnyDesk: `AnyDesk.exe`
- TeamViewer: `TeamViewer.exe`, `tv_w32.exe`, `tv_x64.exe`
- ScreenConnect: `ScreenConnect.ClientService.*`, `ScreenConnect.Client.exe`
- Atera: `AteraAgent.exe`
- Splashtop: `SplashtopRemoteService.exe`, `SRService.exe`, etc.
- Zoho Assist: `ZohoAssist*.exe`
- LogMeIn Rescue: `LMIRescue*.exe`, `rescuetr.exe`

---

### 3.2 Ports (for correlation, not standalone detection)

| Tool           | Ports                                |
|----------------|--------------------------------------|
| Atera          | 443, 80, 5671‚Äì5672, 8800‚Äì8806       |
| ScreenConnect  | 8040‚Äì8043, 443                      |
| AnyDesk        | 80, 443, 6568, UDP 50001            |
| TeamViewer     | 5938 (TCP/UDP), 443, 80             |
| Splashtop      | 443, 80, 6783‚Äì6785, UDP 20803       |
| Zoho Assist    | 443, 80, 8443                       |
| LogMeIn Rescue | 8200‚Äì8201, 443, 80                  |

---

### 3.3 Domains (examples)

| Tool           | Domains (examples)            |
|----------------|------------------------------|
| Atera          | `*.atera.com`, `*.atera.ai`  |
| ScreenConnect  | `*.screenconnect.com`        |
| AnyDesk        | `*.anydesk.com`              |
| TeamViewer     | `*.teamviewer.com`           |
| Splashtop      | `*.splashtop.com`            |
| Zoho Assist    | `*.zohoassist.com`           |
| LogMeIn Rescue | `*.logmeinrescue.com`        |

---

## 4. Splunk Correlation ‚Äì Unauthorized RMM

```splunk
| tstats summariesonly=t count min(_time) as firstTime max(_time) as lastTime 
  from datamodel=Endpoint.Processes
  where (
      Processes.process_name IN ("AnyDesk.exe","TeamViewer.exe","tv_w32.exe","tv_x64.exe",
                                 "ScreenConnect.ClientService.exe","ScreenConnect.Client.exe",
                                 "AteraAgent.exe","SplashtopRemoteService.exe",
                                 "ZohoAssist.exe","LMIRescue.exe","rescuetr.exe")
      OR Processes.process IN ("*AnyDesk*","*TeamViewer*","*ScreenConnect*",
                               "*AteraAgent*","*Splashtop*","*ZohoAssist*","*LogMeIn Rescue*")
  )
  by Processes.dest Processes.user Processes.process_name Processes.process_path
     Processes.parent_process_name Processes.parent_process_path
| `drop_dm_object_name(Processes)`
| lookup approved_rmm_inventory host as dest process_name OUTPUT status AS rmm_status
| where isnull(rmm_status) OR rmm_status!="approved"
| table firstTime lastTime dest user process_name process_path parent_process_name parent_process_path
| rename dest as host
5. Google SecOps / Chronicle ‚Äì YARA-L Rule
rule NL02_01_Unauthorized_RMM_Activity
{
    meta:
        author = "Auto"
        description = "Detects execution of unauthorized RMM remote access tools"
        tactic = "TA0011"
        technique = "T1219"
        severity = "High"
        created = "2025-12-09"

    events:
        $p.metadata.event_type = "PROCESS_LAUNCH"

    condition:
        // RMM binary names
        (
            re.regex($p.target.process.file.name, "(?i)anydesk") or
            re.regex($p.target.process.file.name, "(?i)teamviewer|tv_w32|tv_x64") or
            re.regex($p.target.process.file.name, "(?i)screenconnect") or
            re.regex($p.target.process.file.name, "(?i)ateraagent") or
            re.regex($p.target.process.file.name, "(?i)splashtop") or
            re.regex($p.target.process.file.name, "(?i)zohoassist") or
            re.regex($p.target.process.file.name, "(?i)logmein|lmirescue|rescuetr")
        )
        and
        // Not in allowed RMM list (assume you map this from metadata or enrichment)
        not $p.target.process.file.path in metadata.allowed_rmm_paths
}
You can later replace the generic metadata.allowed_rmm_paths with whatever your Chronicle environment uses (UDM labels, asset groups, etc.).

3. Tool-Specific Cards (Short but Complete)
Below are ‚Äújust enough‚Äù per tool so this answer doesn‚Äôt turn into a small novel. You can expand them later by copy/pasting the master sections.

3.1 Atera ‚Äì detections/rmm/atera.md
# DE02_05_Atera_RMM_Activity

**Tactic:** TA0011 ‚Äì Command and Control  
**Technique:** T1219 ‚Äì Remote Access Software  

## 1. Summary

Detects execution and activity of **Atera RMM agent** (`AteraAgent.exe`) especially where the host is not in the approved Atera deployment list.

## 2. Data Requirements

- Sysmon / EDR process creation & network connection
- Google SecOps PROCESS_LAUNCH, NETWORK_HTTP

Key fields: process_name, process_path, dest, domain, user, host.

## 3. Indicators

- Process: `AteraAgent.exe`
- Paths (examples):
  - `C:\Program Files\Atera Networks\AteraAgent\AteraAgent.exe`
  - Suspicious: `%TEMP%`, `Downloads`, `AppData\Roaming\*Atera*`
- Ports:
  - 443, 80, 5671‚Äì5672, 8800‚Äì8806
- Domains:
  - `*.atera.com`, `*.atera.ai`

## 4. Splunk Query

```splunk
| tstats summariesonly=t count min(_time) as firstTime max(_time) as lastTime 
  from datamodel=Endpoint.Processes
  where Processes.process_name="AteraAgent.exe"
  by Processes.dest Processes.user Processes.process_name Processes.process_path
     Processes.parent_process_name Processes.parent_process_path
| `drop_dm_object_name(Processes)`
| lookup approved_atera_hosts host as dest OUTPUT status AS atera_status
| where isnull(atera_status) OR atera_status!="approved"
| table firstTime lastTime dest user process_name process_path parent_process_name parent_process_path
5. YARA-L Rule (Chronicle)
rule NL02_05_Atera_RMM
{
    meta:
        author = "Auto"
        description = "Detects Atera RMM agent execution on non-approved hosts"
        tactic = "TA0011"
        technique = "T1219"
        severity = "Medium"

    events:
        $p.metadata.event_type = "PROCESS_LAUNCH"

    condition:
        re.regex($p.target.process.file.name, "(?i)ateraagent") and
        not $p.principal.asset.id in metadata.approved_atera_assets
}

---

### 3.2 ScreenConnect ‚Äì `detections/rmm/screenconnect.md`

```markdown
# DE02_06_ScreenConnect_RMM_Activity

**Tactic:** TA0011 ‚Äì Command and Control  
**Technique:** T1219 ‚Äì Remote Access Software  

## 1. Summary

Detects **ConnectWise ScreenConnect** remote access activity (client/service) including self-hosted instances on ports `8040‚Äì8043` or cloud instances over 443.

## 2. Indicators

- Process names:
  - `ScreenConnect.ClientService.exe`
  - `ScreenConnect.Client.exe`
- Ports:
  - 8040‚Äì8043, 443
- Domains:
  - `*.screenconnect.com`
  - custom internal/SaaS hostnames

## 3. Splunk Query

```splunk
| tstats summariesonly=t count min(_time) as firstTime max(_time) as lastTime 
  from datamodel=Endpoint.Processes
  where Processes.process_name IN ("ScreenConnect.ClientService.exe","ScreenConnect.Client.exe")
  by Processes.dest Processes.user Processes.process_name Processes.process_path
     Processes.parent_process_name Processes.parent_process_path
| `drop_dm_object_name(Processes)`
| lookup approved_rmm_inventory host as dest process_name OUTPUT status AS rmm_status
| where isnull(rmm_status) OR rmm_status!="approved"
| table firstTime lastTime dest user process_name process_path parent_process_name parent_process_path
4. YARA-L Rule
rule NL02_06_ScreenConnect_RMM
{
    meta:
        author = "Auto"
        description = "Detects ScreenConnect client or service execution"
        tactic = "TA0011"
        technique = "T1219"
        severity = "High"

    events:
        $p.metadata.event_type = "PROCESS_LAUNCH"

    condition:
        re.regex($p.target.process.file.name, "(?i)screenconnect") and
        not $p.principal.asset.id in metadata.approved_screenconnect_assets
}

---

### 3.3 AnyDesk ‚Äì `detections/rmm/anydesk.md`

```markdown
# DE02_07_AnyDesk_Remote_Access

**Tactic:** TA0011 ‚Äì Command and Control  
**Technique:** T1219 ‚Äì Remote Access Software  

## 1. Summary

Detects **AnyDesk** usage which is often leveraged by threat actors for remote interactive access post-phishing or fake ‚ÄúIT support‚Äù campaigns.

## 2. Indicators

- Process: `AnyDesk.exe`
- Ports: 80, 443, 6568, UDP 50001
- Domains: `*.anydesk.com`
- Suspicious parents:
  - `powershell.exe`
  - `cmd.exe`
  - `winword.exe`, `excel.exe`, `outlook.exe` (phish ‚Üí user runs AnyDesk)

## 3. Splunk Query

```splunk
| tstats summariesonly=t count min(_time) as firstTime max(_time) as lastTime 
  from datamodel=Endpoint.Processes
  where Processes.process_name="AnyDesk.exe"
  by Processes.dest Processes.user Processes.process_name Processes.process_path
     Processes.parent_process_name Processes.parent_process_path
| `drop_dm_object_name(Processes)`
| lookup approved_rmm_inventory host as dest process_name OUTPUT status AS rmm_status
| where isnull(rmm_status) OR rmm_status!="approved"
| table firstTime lastTime dest user process_name process_path parent_process_name parent_process_path
4. YARA-L Rule
rule NL02_07_AnyDesk_Remote
{
    meta:
        author = "Auto"
        description = "Detects AnyDesk remote access client on non-approved hosts"
        tactic = "TA0011"
        technique = "T1219"
        severity = "High"

    events:
        $p.metadata.event_type = "PROCESS_LAUNCH"

    condition:
        re.regex($p.target.process.file.name, "(?i)anydesk") and
        not $p.principal.asset.id in metadata.approved_anydesk_assets
}

---

### 3.4 TeamViewer ‚Äì `detections/rmm/teamviewer.md`

```markdown
# DE02_08_TeamViewer_Remote_Access

**Tactic:** TA0011 ‚Äì Command and Control  
**Technique:** T1219 ‚Äì Remote Access Software  

## 1. Summary

Detects **TeamViewer** remote access sessions, focusing on non-approved hosts or unusual execution contexts.

## 2. Indicators

- Processes:
  - `TeamViewer.exe`, `tv_w32.exe`, `tv_x64.exe`
- Ports:
  - TCP/UDP 5938 (primary)
  - 443, 80 (fallback)
- Domains: `*.teamviewer.com`

## 3. Splunk Query

```splunk
| tstats summariesonly=t count min(_time) as firstTime max(_time) as lastTime 
  from datamodel=Endpoint.Processes
  where Processes.process_name IN ("TeamViewer.exe","tv_w32.exe","tv_x64.exe")
  by Processes.dest Processes.user Processes.process_name Processes.process_path
     Processes.parent_process_name Processes.parent_process_path
| `drop_dm_object_name(Processes)`
| lookup approved_rmm_inventory host as dest process_name OUTPUT status AS rmm_status
| where isnull(rmm_status) OR rmm_status!="approved"
| table firstTime lastTime dest user process_name process_path parent_process_name parent_process_path
4. YARA-L Rule
rule NL02_08_TeamViewer_Remote
{
    meta:
        author = "Auto"
        description = "Detects TeamViewer execution on non-approved assets"
        tactic = "TA0011"
        technique = "T1219"
        severity = "Medium"

    events:
        $p.metadata.event_type = "PROCESS_LAUNCH"

    condition:
        re.regex($p.target.process.file.name, "(?i)teamviewer|tv_w32|tv_x64") and
        not $p.principal.asset.id in metadata.approved_teamviewer_assets
}

---

### 3.5 Splashtop ‚Äì `detections/rmm/splashtop.md`

```markdown
# DE02_09_Splashtop_Remote_Access

**Tactic:** TA0011 ‚Äì Command and Control  
**Technique:** T1219 ‚Äì Remote Access Software  

## 1. Summary

Detects **Splashtop** remote access agents (often bundled inside RMM products).

## 2. Indicators

- Processes:
  - `SplashtopRemoteService.exe`
  - `SRService.exe`
- Ports:
  - 443, 80, 6783‚Äì6785
  - UDP 20803
- Domains:
  - `*.splashtop.com`

## 3. Splunk Query

```splunk
| tstats summariesonly=t count min(_time) as firstTime max(_time) as lastTime 
  from datamodel=Endpoint.Processes
  where Processes.process_name IN ("SplashtopRemoteService.exe","SRService.exe")
  by Processes.dest Processes.user Processes.process_name Processes.process_path
     Processes.parent_process_name Processes.parent_process_path
| `drop_dm_object_name(Processes)`
| lookup approved_rmm_inventory host as dest process_name OUTPUT status AS rmm_status
| where isnull(rmm_status) OR rmm_status!="approved"
| table firstTime lastTime dest user process_name process_path parent_process_name parent_process_path

---

### 3.6 Zoho Assist ‚Äì `detections/rmm/zoho_assist.md`

```markdown
# DE02_10_Zoho_Assist_Remote_Access

**Tactic:** TA0011 ‚Äì Command and Control  
**Technique:** T1219 ‚Äì Remote Access Software  

## 1. Summary

Detects **Zoho Assist** remote support sessions on endpoints where it is not expected.

## 2. Indicators

- Processes: `ZohoAssist*.exe`
- Ports: 443, 80, 8443
- Domains: `*.zohoassist.com`

## 3. Splunk Query

```splunk
| tstats summariesonly=t count min(_time) as firstTime max(_time) as lastTime 
  from datamodel=Endpoint.Processes
  where Processes.process_name LIKE "ZohoAssist%"
  by Processes.dest Processes.user Processes.process_name Processes.process_path
     Processes.parent_process_name Processes.parent_process_path
| `drop_dm_object_name(Processes)`
| lookup approved_rmm_inventory host as dest process_name OUTPUT status AS rmm_status
| where isnull(rmm_status) OR rmm_status!="approved"
| table firstTime lastTime dest user process_name process_path parent_process_name parent_process_path

---

### 3.7 LogMeIn Rescue / GoToAssist ‚Äì `detections/rmm/logmein_rescue.md`

```markdown
# DE02_11_LogMeIn_Rescue_Remote_Access

**Tactic:** TA0011 ‚Äì Command and Control  
**Technique:** T1219 ‚Äì Remote Access Software  

## 1. Summary

Detects **LogMeIn Rescue / GoToAssist** remote support clients, especially incident-driven ‚Äúone off‚Äù sessions from phishing or scam support scenarios.

## 2. Indicators

- Processes:
  - `LMIRescue*.exe`
  - `rescuetr.exe`
- Ports:
  - 8200‚Äì8201, 443, 80
- Domains:
  - `*.logmeinrescue.com`
  - `*.gotoassist.com`

## 3. Splunk Query

```splunk
| tstats summariesonly=t count min(_time) as firstTime max(_time) as lastTime 
  from datamodel=Endpoint.Processes
  where Processes.process_name IN ("LMIRescue.exe","rescuetr.exe")
     OR Processes.process LIKE "LMIRescue%"
  by Processes.dest Processes.user Processes.process_name Processes.process_path
     Processes.parent_process_name Processes.parent_process_path
| `drop_dm_object_name(Processes)`
| lookup approved_rmm_inventory host as dest process_name OUTPUT status AS rmm_status
| where isnull(rmm_status) OR rmm_status!="approved"
| table firstTime lastTime dest user process_name process_path parent_process_name parent_process_path

---

## 4. How to Use This in GitLab

1. **Create directories** in your detection repo using the layout above.
2. **Add each markdown file** into `detections/rmm/`.
3. **Create GitLab issues** using the generic template and paste in the per-tool content.
4. Add labels like:
   - `rmm`
   - `tactic::TA0011`
   - `technique::T1219`
   - `phase::In Progress`, then move through `Needs Peer Review`, `Ready`, `Released`.

---

If you want, next step we can:

- Wire this to your **specific** GitLab labels / milestones (e.g., `Phase::Design`, `Phase::Detection Review`, etc.), or  
- Convert one or two of these to **full-blown PBQs** (multi-step logic, sample logs, expected answers) for training your team.
::contentReference[oaicite:0]{index=0}



No file chosenNo file chosen
ChatGPT can make mistakes. Check important info.
